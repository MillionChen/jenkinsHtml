(window.webpackJsonp=window.webpackJsonp||[]).push([[29],{1676:function(e,t,a){"use strict";var n=a(0);a(227),a(143),a(51),a(20),a(34),a(35),a(23),a(80),a(53),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a(549);var l=n(a(544));a(574);var o=n(a(565));a(140);var r=n(a(535));a(578);var i=n(a(570));a(564);var d=n(a(563));a(99);var u=n(a(100));a(144);var s=n(a(230)),c=n(a(59)),p=n(a(2));a(224);var f=n(a(225)),m=n(a(98));a(537);var h=n(a(536)),g=n(a(29)),y=n(a(30)),v=n(a(32)),b=n(a(33)),C=n(a(31));a(540);var z=n(a(539)),E=n(a(1)),k=a(1019),w=n(a(223)),S=a(52),N=a(65),x=n(a(1677));function I(e){return function(){var t,a=(0,C.default)(e);if(R()){var n=(0,C.default)(this).constructor;t=Reflect.construct(a,arguments,n)}else t=a.apply(this,arguments);return(0,b.default)(this,t)}}function R(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var T=z.default.Item,D=z.default.create()(function(e){(0,v.default)(a,e);var t=I(a);function a(){return(0,g.default)(this,a),t.apply(this,arguments)}return(0,y.default)(a,[{key:"render",value:function(){var e=this.props,t=e.visible,a=e.onCancel,n=e.onCreate,l=e.form.getFieldDecorator,o={labelCol:{xs:{span:24},sm:{span:4}},wrapperCol:{xs:{span:24},sm:{span:20}}};return E.default.createElement(f.default,{visible:t,title:"删除评论",okText:"确定",cancelText:"取消",onCancel:a,onOk:n,destroyOnClose:!0},this.props.record.id&&E.default.createElement(z.default,{layout:"horizontal"},E.default.createElement(T,{style:{display:"none"}},l("id",{initialValue:this.props.record.id})(E.default.createElement(h.default,{className:"dispno"}))),E.default.createElement(T,{style:{display:"none"}},l("flag",{initialValue:this.props.record.flag?this.props.record.flag:"1"})(E.default.createElement(h.default,{className:"dispno"}))),E.default.createElement(T,(0,m.default)({},o,{label:"操作人："}),l("commentator",{initialValue:this.props.record.commentator,rules:[{required:!0,message:"请输入评论人！"}]})(E.default.createElement(h.default,{disabled:!0}))),E.default.createElement(T,(0,m.default)({},o,{label:"删除理由："}),l("rmark",{})(E.default.createElement(h.default.TextArea,null)))))}}]),a}(E.default.Component)),P=function(e){(0,v.default)(a,e);var t=I(a);function a(e){var n;return(0,g.default)(this,a),n=t.call(this,e),(0,p.default)((0,c.default)(n),"handleChange",(function(e){n.setState({value:e})})),(0,p.default)((0,c.default)(n),"handleExpand",(function(e,t){console.log("record.id handleExpand ",t.id),n.props.getreplylist({bizId:t.id},(function(){n.setState({a:2})}))})),(0,p.default)((0,c.default)(n),"showModal",(function(e){n.setState({visible:!0,record:e})})),(0,p.default)((0,c.default)(n),"handleCancel",(function(){n.setState({visible:!1})})),(0,p.default)((0,c.default)(n),"handleCreate",(function(){var e=n.formRef.props.form;e.validateFields((function(t,a){t||(console.log("Received values of form: ",a),"1"===a.flag?(delete a.flag,delete a.commentator,n.props.deleteComment({id:a.id,type:0},{bizId:n.props.match.params.id,bizType:15,pageNo:n.state.pageNo,pageSize:n.state.pageSize})):(console.log("1213213123"),delete a.flag,delete a.commentator,n.props.deleteComment({id:a.id,type:1},{bizId:n.props.match.params.id,bizType:15,pageNo:n.state.pageNo,pageSize:n.state.pageSize})),e.resetFields(),n.setState({visible:!1}))}))})),(0,p.default)((0,c.default)(n),"saveFormRef",(function(e){n.formRef=e})),n.state={pageNo:1,pageSize:20,record:{},visible:!1,value:3,a:1,tableKey:""},n.columns=[{title:"序号",dataIndex:"key",key:"key"},{title:"评论人",dataIndex:"commentator",key:"commentator"},{title:"姓名",dataIndex:"commentatorName",key:"commentatorName",render:function(e){return E.default.createElement("span",{title:e},e)}},{title:"评论对象",dataIndex:"replyName",key:"replyName",render:function(e){return E.default.createElement("span",{title:e},e)}},{title:"评论内容",dataIndex:"content",key:"content",width:"25%",render:function(e){var t="";return t=e.length>100?(t=(t=e.split("")).slice(0,97)).join("")+"...":e,E.default.createElement(s.default,{title:e},E.default.createElement("p",{className:"otwhen",style:{marginBottom:"0em"}},t))}},{title:"评论时间",dataIndex:"createTime",key:"createTime",render:function(e){return E.default.createElement("span",null,(0,w.default)(e).format("YYYY-MM-DD HH:mm:ss"))}},{title:"点赞数",dataIndex:"thumbsUp",key:"thumbsUp",render:function(e){return void 0!==e?E.default.createElement("span",null,e-0,"个 ",E.default.createElement(u.default,{type:"like-o"})):null}},{title:"评论状态",dataIndex:"state",key:"state",render:function(e,t){return E.default.createElement("span",null,1===t.state&&E.default.createElement("span",null,"已上架"),2===t.state&&E.default.createElement("span",null,"已下架"))}},{title:"操作",dataIndex:"operation",key:"operation",render:function(e,t){return E.default.createElement("div",null,1===t.state&&E.default.createElement(d.default,{title:"确定下架此评论？",onConfirm:function(){return n.handleDown(t)}},E.default.createElement("a",null,"下架")),1!=t.state&&E.default.createElement(d.default,{title:"确定上架此评论？",onConfirm:function(){return n.handleUp(t)}},E.default.createElement("a",null,"上架")),"   ",E.default.createElement("a",{onClick:function(){return n.showModal(t)}},"删除"))}}],n.handlePageChange=n.handlePageChange.bind((0,c.default)(n)),n.handlePageSizeChange=n.handlePageSizeChange.bind((0,c.default)(n)),n.downloadCommentFun=n.downloadCommentFun.bind((0,c.default)(n)),n}return(0,y.default)(a,[{key:"componentDidMount",value:function(){this.props.getcommentlist({bizId:this.props.match.params.id,bizType:15,pageNo:this.state.pageNo,pageSize:this.state.pageSize})}},{key:"showTotal",value:function(e){return"共计 ".concat(e," 条")}},{key:"handlePageChange",value:function(e,t){this.setState({pageNo:e}),this.props.getlist({pageNo:e,pageSize:t})}},{key:"handlePageSizeChange",value:function(e,t){this.setState({pageSize:t}),this.props.getlist({pageNo:this.state.pageNo,pageSize:t})}},{key:"downloadCommentFun",value:function(){console.log("点击下载评论"),this.props.downloadComment({bizId:this.props.match.params.id,bizName:this.props.match.params.name,bizType:15})}},{key:"handleUp",value:function(e){var t=this;console.log("record",e),console.log("record.id",e.id);var a;a="reply"==e.flag?1:0,this.props.up({id:e.id,type:a},(function(){1==a?t.props.getreplylist({bizId:e.commentId},(function(){t.setState({a:2,tableKey:new Date})})):t.props.getcommentlist({bizId:t.props.match.params.id,bizType:15,pageNo:t.state.pageNo,pageSize:t.state.pageSize})}))}},{key:"handleDown",value:function(e){var t=this;console.log("record",e),console.log("record.id",e.id),console.log(e.flag);var a;a="reply"==e.flag?1:0,this.props.down({id:e.id,type:a},(function(){1==a?(console.log("回复record",e),t.props.getreplylist({bizId:e.commentId},(function(){t.setState({a:2,tableKey:new Date})}))):t.props.getcommentlist({bizId:t.props.match.params.id,bizType:15,pageNo:t.state.pageNo,pageSize:t.state.pageSize})}))}},{key:"render",value:function(){this.state.value;var e=this.props.commentlist;console.log("this.props==",this.props);location.pathname.split("/")[1],location.pathname.split("/")[2];return E.default.createElement("div",{className:x.default.album_comment_body},E.default.createElement("div",{className:"get-comment",style:{overflow:"hidden",marginBottom:20,marginTop:20}},E.default.createElement(z.default,null,E.default.createElement(o.default,null,E.default.createElement(i.default,{span:4,key:3,style:{float:"left"}},E.default.createElement("h2",{style:{display:"inline-block",marginLeft:"10px",fontWeight:"bolder"}},E.default.createElement("b",null,this.props.match.params.name))),E.default.createElement(i.default,{span:4,key:4,style:{float:"right"}},E.default.createElement(d.default,{title:"确定下载评论信息？",onConfirm:this.downloadCommentFun},E.default.createElement(r.default,{type:"primary"}," 下载评论信息")))))),E.default.createElement(l.default,{key:this.state.tableKey,size:"small",columns:this.columns,dataSource:e.list,onExpand:this.handleExpand,rowKey:"id",pagination:{total:e.listTotal,showTotal:function(){return"共计 "+e.listTotal+"条"},pageSize:this.state.pageSize,showSizeChanger:!0,pageSizeOptions:["10","20","50","100"],current:this.state.pageNo,onChange:this.handlePageChange,onShowSizeChange:this.handlePageSizeChange,showQuickJumper:!0,size:"small"}}),E.default.createElement(D,{record:this.state.record,wrappedComponentRef:this.saveFormRef,visible:this.state.visible,onCancel:this.handleCancel,onCreate:this.handleCreate}))}}]),a}(E.default.Component);var _=(0,S.connect)((function(e,t){return{commentlist:e.albumManagerReducer.commentlist,commentreply:e.albumManagerReducer.commentreply}}),(function(e){return{getcommentlist:function(t){return e((0,k.getCommentList)(t))},getreplylist:function(t,a,n){return e((0,k.getReplyList)(t,a,n))},checkReply:function(t,a){return e((0,k.checkReply)(t,a))},checkcomment:function(t,a){return e((0,k.checkComment)(t,a))},up:function(t,a){return e((0,k.upComment)(t,a))},down:function(t,a){return e((0,k.downComment)(t,a))},downReply:function(t,a){return e((0,k.downReply)(t,a))},downloadComment:function(t,a){return e((0,k.downloadComment)(t,a))},deleteComment:function(t,a){return e((0,k.deleteComment)(t,a))}}}))((0,N.withRouter)(z.default.create()(P)));t.default=_},1677:function(e,t,a){e.exports={album_comment_body:"album_comment_body__WkmiR"}},537:function(e,t,a){"use strict";a.r(t);a(26),a(586),a(140)},565:function(e,t,a){e.exports=a(11)(170)},570:function(e,t,a){e.exports=a(11)(99)},574:function(e,t,a){"use strict";a.r(t);a(26),a(584)},578:function(e,t,a){"use strict";a.r(t);a(26),a(584)},586:function(e,t,a){}}]);