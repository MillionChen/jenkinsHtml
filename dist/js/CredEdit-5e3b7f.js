(window.webpackJsonp=window.webpackJsonp||[]).push([[60,4],{1015:function(e,t,a){},1016:function(e,t,a){},1021:function(e,t,a){},1324:function(e,t,a){"use strict";var l=a(4),n=a(0);a(35),a(53),Object.defineProperty(t,"__esModule",{value:!0}),t.gclfetch=function(e,t){var a=d.default.gclfetch;return function(l){return(0,s.default)({url:a,data:e}).then((function(a){var n=a.data,r=n.records,i=[];if(null!==r){for(var d=0;d<r.length;d++)i.push({code:r[d].code,id:r[d].id,key:d+1+e.pageSize*(e.pageNo-1),url:r[d].logourl,title:r[d].title,time:r[d].createTime,state:r[d].status,total:n.total,createByName:r[d].createByName,templateImage:r[d].templateImage,grantNum:r[d].grantNum,relationNum:r[d].relationNum});t&&t()}console.log(i),l({type:u.GET_CRED_LIST,data:i}),l({type:u.GET_CRED_DETAILS,data:{}})}))}},t.gcsfetch=function(e,t){var a=d.default.gcsfetch;return function(l){return(0,s.default)({url:a,data:e}).then((function(e){l({type:u.CUT_CRED_BOARD,data:e.data}),t&&t(),4e3==e.code&&r.default.error(e.subMsg),l({type:u.CUT_CRED_BOARD,data:e.data})}))}},t.ccfetch=function(e,t){var a=d.default.ccfetch;return function(l){return(0,s.default)({url:a,data:e}).then((function(a){l({type:u.ADD_CRED_BOARD,data:e}),t&&t()}))}},t.getfetch=function(e,t){return function(a){if("new"!==e.id){var l=d.default.getfetch;return(0,s.default)({url:l,data:e}).then((function(e){var l=e.data;switch(a({type:u.GET_CRED_DETAILS,data:l}),l.type){case 0:a({type:u.GET_TIME_RADIO,data:{rstate1:!0,rstate2:!0}});break;case 1:a({type:u.GET_TIME_RADIO,data:{rstate1:!1,rstate2:!0}});break;case 2:a({type:u.GET_TIME_RADIO,data:{rstate1:!0,rstate2:!1}});break;default:a({type:u.GET_TIME_RADIO,data:{rstate1:!0,rstate2:!0}})}a({type:u.GET_TAGS,data:null!==l.tags?l.tags.split(","):null}),t&&t()}))}a({type:u.GET_CRED_DETAILS,data:{}}),a({type:u.GET_TIME_RADIO,data:{rstate1:!0,rstate2:!0}})}},t.ucfetch=function(e,t){var a=d.default.ucfetch;return function(l){return(0,s.default)({url:a,data:e}).then((function(e){"1000"===e.code?(r.default.success("修改成功"),t&&t()):r.default.error("修改失败，请重新尝试...")}))}},t.unfetch=function(e){var t=d.default.unfetch;return function(a){return(0,s.default)({url:t,data:e}).then((function(e){if("1000"===e.code)return r.default.success("创建成功"),e;r.default.error("创建失败，请重新尝试...")}))}},t.gcbfetch=function(e){var t=d.default.gcbfetch;return function(a){return(0,s.default)({url:t}).then((function(t){console.log("jjjjjjj",t.data),a({type:u.GET_CRED_BOARD,data:t.data}),e&&e()}))}},t.cutfetch=function(e){var t=d.default.gcbfetch;return function(a){return(0,s.default)({url:t,data:e}).then((function(e){a({type:u.CUT_CRED_BOARD,data:e.data})}))}},t.analysisfetch=function(e,t){return function(a){return(0,s.default)({url:d.default.analysisfetch,data:e}).then((function(e){"1000"===e.code?(a({type:u.ADD_CRED_BOARD,data:e.data}),t&&t(),r.default.success("上传成功")):r.default.error("解析失败，请重新尝试...")}))}},t.addfetch=function(e,t){return function(a){a({type:ADD_CRED_BOARD,data:e}),t&&t()}},t.gtimeradio=function(e){return function(t){switch(e){case 0:t({type:u.GET_TIME_RADIO,data:{rstate1:!0,rstate2:!0}});break;case 1:t({type:u.GET_TIME_RADIO,data:{rstate1:!1,rstate2:!0}});break;case 2:t({type:u.GET_TIME_RADIO,data:{rstate1:!0,rstate2:!1}});break;default:t({type:u.GET_TIME_RADIO,data:{rstate1:!0,rstate2:!0}})}}},t.getClassifyList=function(e){var t=d.default.getClassifyList;return function(a){return(0,s.default)({url:t}).then((function(t){"1000"===t.code?(a({type:"CRED_CLASSIFY_LIST",data:t.data}),e&&e()):r.default.error(t.subMsg)}))}},t.delClassify=function(e,t){var a=d.default.delClassify;return function(l){return(0,s.default)({url:a,data:e}).then((function(e){"1000"===e.code?t&&t(e):r.default.error(e.subMsg)}))}},t.createClassify=function(e,t){var a=d.default.createClassify;return function(l){return(0,s.default)({url:a,data:e}).then((function(e){"1000"===e.code?t&&t(e):r.default.error(e.subMsg)}))}},t.updateClassify=function(e,t){var a=d.default.updateClassify;return function(l){return(0,s.default)({url:a,data:e}).then((function(e){"1000"===e.code?t&&t(e):r.default.error(e.subMsg)}))}},t.getActivityList=function(e,t){var a=d.default.getActivityList;return function(l){return(0,s.default)({url:a,data:e}).then((function(e){"1000"===e.code?(l({type:"CRED_ACTIVITY_LIST",data:e.data}),t&&t()):r.default.error(e.subMsg)}))}},t.listExport=function(e,t){var a=d.default.listExport;return function(l){return(0,s.default)({url:a,data:e}).then((function(e){"1000"===e.code?t&&t(e):r.default.error(e.subMsg)}))}},t.reportListByCred=function(e,t){var a=d.default.reportListByCred;return function(l){return(0,s.default)({url:a,data:e}).then((function(e){"1000"===e.code?(l({type:"CRED_REPORT_LIST_BY_CRED",data:e.data}),t&&t(e)):r.default.error(e.subMsg)}))}},t.exportReportListByCred=function(e,t){var a=a.exportReportListByCred;return function(l){return(0,s.default)({url:a,data:e}).then((function(e){"1000"===e.code?t&&t(e):r.default.error(e.subMsg)}))}},t.getCertificateList=function(e,t){var a=d.default.getCertificateList;return function(l){return(0,s.default)({url:a,data:e}).then((function(e){"1000"===e.code?(l({type:"CRED_LIST_RAW",data:e.data}),t&&t(e)):r.default.error(e.subMsg)}))}},a(61);var r=n(a(62)),i=a(233),u=(a(636),l(a(1325))),d=n(a(1326)),s=n(a(78));location.pathname.split("/")[1],location.pathname.split("/")[2],(0,i.createAction)(u.GET_CRED_LIST),(0,i.createAction)(u.GET_CRED_STATE),(0,i.createAction)(u.COPY_CRED),(0,i.createAction)(u.UPDATE_CRED),(0,i.createAction)(u.NEW_CRED),(0,i.createAction)(u.GET_UPLOAD_PARAM),(0,i.createAction)(u.GET_CRED_BOARD),(0,i.createAction)(u.GET_TIME_RADIO),(0,i.createAction)(u.GET_TAGS)},1325:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GET_TAGS=t.GET_TIME_RADIO=t.ADD_CRED_BOARD=t.CUT_CRED_BOARD=t.GET_CRED_BOARD=t.GET_UPLOAD_PARAM=t.CRED_CHART_EXPORT=t.GET_CRED_CHART=t.UPDATE_CRED=t.COPY_CRED=t.NEW_CRED=t.GET_CRED_DETAILS=t.GET_CRED_STATE=t.GET_CRED_LIST=void 0;t.GET_CRED_LIST="GET_CRED_LIST";t.GET_CRED_STATE="GET_CRED_STATE";t.GET_CRED_DETAILS="GET_CRED_DETAILS";t.NEW_CRED="NEW_CRED";t.COPY_CRED="COPY_CRED";t.UPDATE_CRED="UPDATE_CRED";t.GET_CRED_CHART="GET_CRED_CHART";t.CRED_CHART_EXPORT="CRED_CHART_EXPORT";t.GET_UPLOAD_PARAM="GET_UPLOAD_PARAM";t.GET_CRED_BOARD="GET_CRED_BOARD";t.CUT_CRED_BOARD="CUT_CRED_BOARD";t.ADD_CRED_BOARD="ADD_CRED_BOARD";t.GET_TIME_RADIO="GET_TIME_RADIO";t.GET_TAGS="GET_TAGS"},1326:function(e,t,a){"use strict";var l=a(0);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=l(a(63)),r={gclfetch:"GET ".concat(n.default.webManage,"/certificate/list"),gcsfetch:"POST ".concat(n.default.webManage,"/certificate/enable"),ccfetch:"POST ".concat(n.default.webManage,"/certificate/copy"),getfetch:"GET ".concat(n.default.webManage,"/certificate/get"),ucfetch:"POST ".concat(n.default.webManage,"/certificate/update"),unfetch:"POST ".concat(n.default.webManage,"/certificate/save"),gcbfetch:"GET ".concat(n.default.webManage,"/certificate/template"),analysisfetch:"GET ".concat(n.default.webManage,"/certificate/analysis"),getClassifyList:"GET ".concat(n.default.webManage,"/certificate/classify/list"),delClassify:"GET ".concat(n.default.webManage,"/certificate/classify/delete"),createClassify:"POST ".concat(n.default.webManage,"/certificate/classify/insert"),updateClassify:"POST ".concat(n.default.webManage,"/certificate/classify/update"),getActivityList:"GET ".concat(n.default.webManage,"/certificate/getRelationActivities"),listExport:"GET ".concat(n.default.webManage,"/certificate/list/export"),reportListByCred:"GET ".concat(n.default.webManage,"/report/certificate/certificateList"),exportReportListByCred:"GET ".concat(n.default.webManage,"/report/certificate/certificateStatisticsExport"),getCertificateList:"GET ".concat(n.default.webManage,"/certificate/list")};t.default=r},2116:function(e,t,a){"use strict";var l=a(4),n=a(0);a(44),a(101),a(40),a(51),a(633),a(20),a(34),a(35),a(23),a(82),a(234),a(53),a(228),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a(580);var r=n(a(571));a(140);var i=n(a(535));a(99);var u=n(a(100));a(592);var d=n(a(566));a(554);var s=n(a(550));a(807);var o=n(a(808)),c=n(a(98));a(224);var f=n(a(225));a(598);var p=n(a(768));a(61);var m=n(a(62)),g=n(a(29)),h=n(a(30)),E=n(a(59)),_=n(a(32)),y=n(a(33)),v=n(a(31)),T=n(a(2));a(556);var C=n(a(553));a(540);var b=n(a(539));a(537);var I=n(a(536)),R=l(a(1)),D=n(a(2117)),A=a(65),S=n(a(223)),O=n(a(771)),k=a(1324),w=n(a(226)),G=a(561),L=n(a(628)),M=a(52),P=n(a(653)),B=a(164);function x(e){return function(){var t,a=(0,v.default)(e);if(U()){var l=(0,v.default)(this).constructor;t=Reflect.construct(a,arguments,l)}else t=a.apply(this,arguments);return(0,y.default)(this,t)}}function U(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}I.default.TextArea;var N=b.default.Item,V=C.default.Group,z=location.pathname.split("/")[1],F=location.pathname.split("/")[2],j=function(e){(0,_.default)(a,e);var t=x(a);function a(e){var l,n;return(0,g.default)(this,a),n=t.call(this,e),(0,T.default)((0,E.default)(n),"reBuildDataForCascader",(function(e){var t=(0,E.default)(n),a=[];e.map((function(e,t){e.children&&e.children.length>0&&e.children.map((function(t,a){e.children[a]={label:t.name,value:t.id,children:t.children,level:t.level,parentId:e.id},t.children&&t.children.length>0&&t.children.map((function(e,a){t.children[a]={label:e.name,value:e.id,children:e.children,level:e.level}}))})),a.push({label:e.name,value:e.id,children:e.children,level:e.level})})),console.log("reClassifyListForCascader==",a),t.setState({reClassifyListForCascader:a})})),(0,T.default)((0,E.default)(n),"getTemplate2",(function(e){console.log("radio2",e);var t=n.props,a=t.update,l=t.board;3==e.target.value&&n.state.templateTypeFlag?n.setState({templateId:a.templateId,templateImage:a.templateImage,template:a.template,templateType:e.target.value}):3!=e.target.value||n.state.templateTypeFlag?2==e.target.value&&n.setState({templateId:l[0].id,templateImage:l[0].templateImage,template:l[0].templateUrl,templateType:0}):n.setState({templateId:"",templateImage:"",template:"",templateType:e.target.value})})),(0,T.default)((0,E.default)(n),"getImgUrl",(function(e){n.props.form.setFieldsValue({logo:e}),n.setState({logourl:e})})),(0,T.default)((0,E.default)(n),"handleSubmit",(function(){console.log(n.state.templateImage),console.log("zzzzzz",n.state.logourl),n.props.form.validateFields((function(e,t){if(console.log("数据：",t),e)console.log(e);else{n.setState({loading:!0}),t.title=t.title.trim(),t.classifyId=t.classifyId[t.classifyId.length-1];var a=n.validate;if("new"===n.state.credId){var l="";if(a&&a.validateFields((function(e,t){if(e)return console.log(e),l=e,void n.setState({loading:!1})})),1!==t.type&&(t.circleCount=""),null!==t.endTime&&(t.endTime=t.endTime.format("YYYY-MM-DD")+" 23:59:59"),t.logourl=n.state.logourl,0!==n.state.tags.length&&(t.tags=n.state.tags.toString()),n.state.template.length<10)return m.default.warning("请选择证书模板"),void n.setState({loading:!1});t.templateId=n.state.templateId,t.templateImage=n.state.templateImage,t.template=n.state.template,console.log(1111,t),""===l&&(n.props.unfetch(t).then((function(){n.props.history.push("/".concat(z,"/").concat(F,"/index/tool/cred/manager"))})),setTimeout((function(){n.setState({loading:!1})}),2e3))}else{if(console.log("this.state.logourl==",n.state.logourl),t.id=n.state.credId,1!==t.type&&(t.circleCount=""),null!==t.endTime&&(t.endTime=t.endTime.format("YYYY-MM-DD")+" 23:59:59"),t.logourl=0===n.state.logourl.length?n.props.update.logourl:n.state.logourl,0!==n.state.tags.length&&(t.tags=n.state.tags.toString()),n.state.template.length<10)return m.default.warning("请选择证书模板"),void n.setState({loading:!1});t.templateId=n.state.templateId,t.templateImage=n.state.templateImage,t.template=n.state.template,console.log(2222,t),n.props.onUpdate(t,(function(){n.props.history.push("/".concat(z,"/").concat(F,"/index/tool/cred/manager"))})),setTimeout((function(){n.setState({loading:!1})}),2e3)}}}))})),n.state=(l={loading:!1,previewVisible:!1,previewVisible1:!1,previewImage:"",uploadParam:{},uploadAction:"",rstate1:!0,rstate2:!0,logourl:"",fileList:[],templateImgs:[],boardList:[],tags:[],inputVisible:!1,inputValue:"",templateId:"",templateImage:"",template:"",uploadPercent:0,uploadProgress:!1,romdom:""},(0,T.default)(l,"logourl",""),(0,T.default)(l,"selectedOptionsId",[]),(0,T.default)(l,"reClassifyListForCascader",[]),(0,T.default)(l,"boardCard",{}),(0,T.default)(l,"templateType",0),(0,T.default)(l,"templateTypeFlag",!1),(0,T.default)(l,"credId",n.props.match.params.credid),l),n.beforeUpload=n.beforeUpload.bind((0,E.default)(n)),n.handleRadioValue=n.handleRadioValue.bind((0,E.default)(n)),n.getTemplate=n.getTemplate.bind((0,E.default)(n)),n.handleChange=n.handleChange.bind((0,E.default)(n)),n.closeUploadProgress=n.closeUploadProgress.bind((0,E.default)(n)),n.showTemplate=n.showTemplate.bind((0,E.default)(n)),n.handleCancel=n.handleCancel.bind((0,E.default)(n)),n}return(0,h.default)(a,[{key:"componentDidMount",value:function(){var e=this,t=this,a=location.pathname.split("/"),l=(a.pop(),a.pop());if(console.log(l,"------credId------"),"new"===l){var n=this.props.location.query,r=n.classifyId,i=n.parentClassifyId,u=n.grandId;this.setState({selectedOptionsId:u?[u,i,r]:i?[i,r]:[r],credId:l})}this.props.gcbfetch((function(){e.setState({templateImage:e.props.board[0].templateImage,templateImgs:e.props.board,template:e.props.board[0].templateUrl,templateId:e.props.board[0].id},(function(){t.props.getfetch({id:l},(function(a){if("new"!=e.state.credId){var l=t.props.update,n=l.oneLevelId,r=l.twoLevelId,i=l.classifyId;t.setState({selectedOptionsId:r?[n,r,i]:n?[n,i]:[i]})}for(var u=t.props,d=u.update,s=u.board,o=3,c=0;c<s.length;c++)s[c].id==d.templateId&&(o=c);t.setState({logourl:d.logourl,templateImage:d.templateImage,template:d.template,uploadParam:{Filename:d.template},boardCard:{id:d.templateId,templateImage:d.templateImage,templateUrl:d.template},templateType:o,templateTypeFlag:3==o})}))}))})),this.props.gupfetch(),this.props.getClassifyList((function(){var e=t.props.classifyList;t.reBuildDataForCascader(e)}))}},{key:"getTemplate",value:function(e){console.log("radio1",e);var t=this.props.board;this.setState({templateId:t[e.target.value].id,templateImage:t[e.target.value].templateImage,template:t[e.target.value].templateUrl,templateType:e.target.value})}},{key:"beforeUpload",value:function(e,t){var a=e.name.split(".");if("zip"===a[a.length-1]){var l=this.props.param,n=Date.parse(new Date)+".zip";this.setState({uploadParam:{Filename:l.dir+"/"+e.name,key:l.dir+"/"+n,policy:l.policy,OSSAccessKeyId:l.accessid,success_action_status:"200",signature:l.signature},uploadAction:l.host,uploadProgress:!0,templateurl:l.host+"/"+l.dir+"/"+n})}else m.default.info("请上传.zip格式的文件")}},{key:"handleChange",value:function(e){var t=this;console.log("2222",e);var a=this;e.fileList.length||console.log(history);var l=e.fileList;e.event&&this.setState({uploadPercent:e.event.percent.toFixed(0)-0});var n=e.file.name.replace(".zip",(new Date).getTime()+".zip");"done"===e.file.status&&(this.setState({fileList:l}),this.props.analysis({url:this.state.templateurl,fileName:n},(function(e){var l=a.props.boardCard;t.setState({uploadProgress:!1,templateId:l.id,templateImage:l.templateImage,template:l.templateUrl})}))),"error"===e.file.status&&(m.default.error("上传失败，请重新尝试"),this.setState({uploadProgress:!1}))}},{key:"handleRadioValue",value:function(e){console.log(e.target.value);var t=this.props.update;t.circleCount;2!==e.target.value&&(t.endTime=null,this.props.form.resetFields(["endTime"])),1!==e.target.value&&(t.circleCount=null,t.circleUnit=null,this.props.form.resetFields(["circleCount","circleUnit"])),this.props.gtimeradio(e.target.value)}},{key:"showTemplate",value:function(){this.setState({previewVisible:!0})}},{key:"handleCancel",value:function(){this.setState({previewVisible:!1})}},{key:"closeUploadProgress",value:function(){this.setState({fileList:[],uploadProgress:!1})}},{key:"render",value:function(){var e,t=this,a=this.props,l=a.update,n=a.timeRadio,m=a.board;console.log("this.props==",this.props),console.log("this.state==",this.state);var g=this.props.form.getFieldDecorator,h=this.state,E=h.uploadParam,_=h.uploadAction,y=(h.previewVisible1,h.previewImage,h.fileList,h.logourl),v=(h.templateImgs,h.boardCard,{labelCol:{span:6},wrapperCol:{span:14}}),k={display:"block",height:"30px",lineHeight:"30px"},G={defaultTags:[],getTags:function(e){console.log(t),t.setState({tags:e})}},M={defaultTags:(0,B.isEmpty)(l)?[]:l.tags&&l.tags.length>0?l.tags.split(","):[],getTags:function(e){console.log(t),t.setState({tags:e})}},x=location.pathname.indexOf("look")>-1;e={required:!0,name:"证书缩略图："},(0,T.default)(e,"required",!0),(0,T.default)(e,"layout",{labelCol:{span:6},wrapperCol:{span:14}}),(0,T.default)(e,"defaultUrl",[]),(0,T.default)(e,"getUrl",(function(e){t.setState({logourl:e})})),(0,B.isEmpty)(l)||l.logourl&&l.logourl;return R.default.createElement("div",{className:D.default.cred_edit},R.default.createElement(w.default,{title:l&&l.title?"查看证书":"新增证书"}),R.default.createElement(f.default,{title:"上传进度",visible:this.state.uploadProgress,footer:null,onCancel:this.closeUploadProgress},R.default.createElement(p.default,{percent:this.state.uploadPercent})),R.default.createElement(f.default,{visible:this.state.previewVisible,footer:null,onCancel:this.handleCancel},R.default.createElement("img",{alt:"证书模板",style:{width:"100%"},src:this.state.templateImage})),R.default.createElement(b.default,null,R.default.createElement("p",{className:D.default.credEditTitle},"证书基础信息"),R.default.createElement(N,(0,c.default)({},v,{label:"证书名称："}),g("title",{initialValue:(0,B.isEmpty)(l)?"":l.title?l.title:"",rules:[{required:!0,validator:function(e,t,a){(0,L.default)(e,t,a,"请输少于50字的证书名称",50)}}]})(R.default.createElement(I.default,{placeholder:"标识证书，如新员工培训",disabled:x}))),R.default.createElement(N,(0,c.default)({},v,{label:"证书缩略图："}),g("logo",{rules:[{required:!0,message:"请证书缩略图"}],initialValue:l&&l.logourl||y})(R.default.createElement(P.default,{details:l&&l.logourl||y,getImgUrl:this.getImgUrl,preRatio:["1/1"],maxSize:500,extra:"图片最佳尺寸：360*360，比例为1：1，支持jpg、png、jpeg"}))),R.default.createElement(N,(0,c.default)({},v,{label:"文件夹："}),g("classifyId",{initialValue:this.state.selectedOptionsId,rules:[{required:!0,message:"请选择文件夹"}]})(R.default.createElement(o.default,{placeholder:"请选择文件夹",disabled:x,changeOnSelect:!0,options:this.state.reClassifyListForCascader}))),R.default.createElement(N,(0,c.default)({},v,{label:"发证机构："}),g("issuer",{initialValue:(0,B.isEmpty)(l)?"":l.issuer?l.issuer:""})(R.default.createElement(I.default,{placeholder:"请输入发证机构",disabled:x}))),R.default.createElement(N,(0,c.default)({},v,{label:"证书编号规则"}),g("ruleType",{initialValue:(0,B.isEmpty)(l)?0:l.ruleType?l.ruleType:0})(R.default.createElement(s.default,null,R.default.createElement(Option,{key:0,value:0},"获取时间+6位顺序编号"),R.default.createElement(Option,{key:1,value:1},"6位顺序编号"))),R.default.createElement(Y,null)),R.default.createElement(N,(0,c.default)({},v,{label:"有效期："}),g("type",{initialValue:(0,B.isEmpty)(l)?0:l.type?l.type:0,rules:[{required:!0,message:"请选择有效期"}]})(R.default.createElement(V,{onChange:this.handleRadioValue,disabled:x},R.default.createElement(C.default,{style:k,value:0},"永不过期"),R.default.createElement(C.default,{style:k,value:1},"固定周期，获证后",R.default.createElement(N,{className:D.default.credEditExpe},g("circleCount",{initialValue:(0,B.isEmpty)(l)?"":l.circleCount?l.circleCount:""})(R.default.createElement(I.default,{className:D.default.credEditRadioInput,size:"small",disabled:n.rstate1}))),R.default.createElement(N,{className:D.default.credEditExpe},g("circleUnit",{initialValue:(0,B.isEmpty)(l)?"":l.circleUnit?l.circleUnit:""})(R.default.createElement(s.default,{size:"small",className:D.default.credEditRadioSelect,disabled:n.rstate1},R.default.createElement(Option,{key:1,value:"0"},"年"),R.default.createElement(Option,{key:2,value:"1"},"月"),R.default.createElement(Option,{key:3,value:"2"},"日"))))),R.default.createElement(C.default,{style:k,value:2},"固定失效日期",R.default.createElement(N,{className:D.default.credEditExpe},g("endTime",{initialValue:!n.rstate2&&l.endTime?(0,S.default)(l.endTime):null})(R.default.createElement(d.default,{className:D.default.credEditRadioDatePicker,size:"small",placeholder:"请选择日期",disabled:!!x||n.rstate2}))))))),R.default.createElement(N,(0,c.default)({},v,{label:"自定义关键词："}),"new"===this.state.credId&&R.default.createElement(O.default,(0,c.default)({},G,{disable:x})),"new"===this.state.credId&&void 0!==l.tags&&R.default.createElement(O.default,(0,c.default)({},M,{disable:x}))),R.default.createElement("p",{className:D.default.credEditTitle},"证书模板信息"),m&&m.length>0&&R.default.createElement(N,(0,c.default)({},v,{label:"选择模板："}),g("templateId",{initialValue:3==this.state.templateType?3:2,rules:[{required:!0,message:"请选择模板"}]})(R.default.createElement(V,{onChange:this.getTemplate2,disabled:x},R.default.createElement(C.default,{value:2,key:1},R.default.createElement(V,{onChange:this.getTemplate,disabled:3==this.state.templateType||x,value:this.state.templateType},"系统模板:    ",R.default.createElement(C.default,{value:0,key:11},R.default.createElement("div",{className:D.default.credEditBoard},R.default.createElement("img",{className:D.default.credEditBoardImg,src:m[0].templateImage,alt:"模板"}))),R.default.createElement(C.default,{value:1,key:12},R.default.createElement("div",{className:D.default.credEditBoard},R.default.createElement("img",{className:D.default.credEditBoardImg,src:m[1].templateImage,alt:"模板"}))))),R.default.createElement("br",null),R.default.createElement(C.default,{value:3,key:2},"自定义模板:    ",R.default.createElement("div",{className:D.default.credEditBoard,style:{display:3==this.state.templateType?"inline-block":"none"}},this.state.templateImage.length<10?null:R.default.createElement("img",{className:D.default.credEditBoardImg,src:this.state.templateImage,alt:"模板"})),this.state.templateImage.length<10?R.default.createElement("div",{style:{position:"absolute",top:30,left:152,textAlign:"center"}},R.default.createElement(u.default,{type:"plus"}),R.default.createElement("br",null),"上传"):null,R.default.createElement("div",{style:{display:"inline-block"}},R.default.createElement(r.default,{headers:{"X-Requested-With":null},beforeUpload:this.beforeUpload,action:_,data:E,showUploadList:!1,onChange:this.handleChange},R.default.createElement(i.default,{disabled:x||3!=this.state.templateType},R.default.createElement(u.default,{type:"upload"})," 上传证书模板"))))))),R.default.createElement("p",{className:D.default.cred_edit_board_hint},"提示：可点击下载“",R.default.createElement("a",{disabled:x,href:"https://cloud-wmy.oss-cn-shanghai.aliyuncs.com/wmy/zhengshu.zip",className:"cred-edit-board-hint-pag"},"证书代码包"),"”，依据提示进行证书模板制作后上传！")),R.default.createElement("div",{className:D.default.credEditBtns},R.default.createElement(i.default,{type:"primary",className:D.default.credEditBtn,onClick:this.showTemplate},"预览"),-1==location.pathname.indexOf("look")&&R.default.createElement(i.default,{className:D.default.credEditBtn,type:"primary",onClick:this.handleSubmit,loading:this.state.loading},"保存"),R.default.createElement(A.Link,{to:"/"+z+"/"+F+"/index/tool/cred/manager"},R.default.createElement(i.default,{className:D.default.credEditBtn},"取消"))))}}]),a}(R.Component),Y=function(e){(0,_.default)(a,e);var t=x(a);function a(e){var l;return(0,g.default)(this,a),(l=t.call(this,e)).state={visible:!1},l}return(0,h.default)(a,[{key:"showModal",value:function(){this.setState({visible:!0})}},{key:"handleOk",value:function(e){this.setState({visible:!1})}},{key:"handleCancel",value:function(e){this.setState({visible:!1})}},{key:"render",value:function(){return R.default.createElement("div",{style:{display:"inline-block"}},R.default.createElement("span",{onClick:this.showModal.bind(this),style:{position:"absolute",width:"20px",height:"20px",border:"1px solid",borderRadius:"50%",textAlign:"center",lineHeight:"20px",top:"0px",marginLeft:"10px"}},"?"),R.default.createElement(f.default,{title:"证书编号说明",visible:this.state.visible,onOk:this.handleOk.bind(this),onCancel:this.handleCancel.bind(this),footer:null,width:550},R.default.createElement("p",null,"证书编号指学员获取证书时打印在证书上的编号，目前可选择两种编号规则："),R.default.createElement("h4",null,"（1）获取时间+6位顺序编号"),R.default.createElement("p",null,"使用该编号规则时，学员获取的编号为14位数字，分别为获取时间（8位数）+6位数的证书顺序编号。6位数顺序编号指当前站点学员获取证书的打印顺序。例如学员A在2019年3月12日获取了一个证书，该证书为当前站点第100个打印的证书，那么学员A获取的证书编号为20190312000100"),R.default.createElement("h4",null,"（2）6位顺序编号"),R.default.createElement("p",null,"使用该编号规则时，学员获取的编号为6位数字，即6位数的证书顺序编号。例如学员A在2019年3月12日获取了一个证书，该证书为当前站点第100个打印的证书，那么学员A获取的证书编号为000100")))}}]),a}(R.Component);var q=(0,M.connect)((function(e,t){return{param:e.uploadParam.param,update:null!==e.credential.update?e.credential.update:{},board:e.credential.board,boardCard:e.credential.boardCard,timeRadio:e.credential.timeRadio,tags:e.credential.tags,classifyList:e.credential.classifyList}}),(function(e){return{gupfetch:function(){return e((0,G.gupfetch)())},onUpdate:function(t,a){return e((0,k.ucfetch)(t,a))},gcbfetch:function(t){return e((0,k.gcbfetch)(t))},cutfetch:function(t){return e((0,k.cutfetch)(t))},gtimeradio:function(t){return e((0,k.gtimeradio)(t))},getfetch:function(t,a){return e((0,k.getfetch)(t,a))},unfetch:function(t){return e((0,k.unfetch)(t))},analysis:function(t,a){return e((0,k.analysisfetch)(t,a))},addfetch:function(t,a){return e((0,k.addfetch)(t,a))},getClassifyList:function(t,a){return e((0,k.getClassifyList)(t,a))}}}))(b.default.create()((0,A.withRouter)(j)));t.default=q},2117:function(e,t,a){e.exports={cred_edit:"cred_edit__cQGj9",cred_edit_logo:"cred_edit_logo__SSdaV","ant-upload-list-item-actions":"ant-upload-list-item-actions__3leFK","anticon-delete":"anticon-delete__2gKXe","anticon-eye-o":"anticon-eye-o__3G3DQ",credEditBoard:"credEditBoard__20-Dg",cred_edit_board_hint:"cred_edit_board_hint__23RIl",credEditBoardHintPag:"credEditBoardHintPag__1AOkN",credEditTitle:"credEditTitle__BZiMf",credEditBtns:"credEditBtns__2C3WZ",credEditBtn:"credEditBtn__3_LNo",credEditRadioInput:"credEditRadioInput__1W2Nq",credEditRadioSelect:"credEditRadioSelect__2za92",credEditRadioDatePicker:"credEditRadioDatePicker__1nT9N",credEditBoardImg:"credEditBoardImg__2_37Y",credEditLogo:"credEditLogo__3MJSQ",credEditBoardUpload:"credEditBoardUpload__2dkHp",credEditExpe:"credEditExpe__1IzOf"}},540:function(e,t,a){"use strict";a.r(t);a(26),a(577),a(584)},550:function(e,t,a){e.exports=a(11)(94)},554:function(e,t,a){"use strict";a.r(t);a(26),a(1021),a(655)},556:function(e,t,a){"use strict";a.r(t);a(26),a(1016)},566:function(e,t,a){e.exports=a(11)(817)},574:function(e,t,a){"use strict";a.r(t);a(26),a(584)},577:function(e,t,a){},580:function(e,t,a){"use strict";a.r(t);a(26),a(625),a(598),a(144)},598:function(e,t,a){"use strict";a.r(t);a(26),a(626)},619:function(e,t,a){e.exports=a(11)(415)},625:function(e,t,a){},626:function(e,t,a){},628:function(e,t,a){"use strict";a(156),a(35),a(23),a(228),Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,a,l,n){var r=[];new RegExp(/^\s+/,"i");t||(t="");""===t.trim()&&t.length>0&&r.push(new Error(l,e.field));0==t.length&&e.required&&r.push(new Error(l,e.field));t.length>n&&r.push(new Error("最多支持输入"+n+"个字符以内",e.field));a(r)}},636:function(e,t,a){e.exports=a(46)(174)},655:function(e,t,a){"use strict";a(26),a(1015)},768:function(e,t,a){e.exports=a(11)(416)},771:function(e,t,a){"use strict";var l=a(4),n=a(0);a(44),a(3),a(101),a(227),a(40),a(143),a(20),a(34),a(35),a(23),a(234),a(53),a(144);var r=n(a(230));a(648);var i=n(a(619));a(99);var u=n(a(100));a(537);var d=n(a(536)),s=n(a(81));a(61);var o=n(a(62)),c=n(a(29)),f=n(a(30)),p=n(a(59)),m=n(a(32)),g=n(a(33)),h=n(a(31)),E=n(a(2)),_=l(a(1));function y(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var v=function(e){(0,m.default)(l,e);var t,a=(t=l,function(){var e,a=(0,h.default)(t);if(y()){var l=(0,h.default)(this).constructor;e=Reflect.construct(a,arguments,l)}else e=a.apply(this,arguments);return(0,g.default)(this,e)});function l(e){var t;return(0,c.default)(this,l),t=a.call(this,e),(0,E.default)((0,p.default)(t),"saveInputRef",(function(e){return t.input=e})),t.props.init&&t.props.init((0,p.default)(t)),t.state={tags:t.props.defaultTags?t.props.defaultTags:[],inputVisible:!1,inputValue:""},t.showInput=t.showInput.bind((0,p.default)(t)),t.handleClose=t.handleClose.bind((0,p.default)(t)),t.handleInputConfirm=t.handleInputConfirm.bind((0,p.default)(t)),t.handleInputChange=t.handleInputChange.bind((0,p.default)(t)),console.log(t.props.defaultTags),t}return(0,f.default)(l,[{key:"initTags",value:function(e){this.setState({tags:e})}},{key:"handleClose",value:function(e){var t=this.state.tags.filter((function(t){return t!==e}));this.setState({tags:t});var a=this.props.getTags;a&&a(t)}},{key:"showInput",value:function(){var e=this;this.state.tags&&this.state.tags.length>=5?o.default.error("最多只能添加5个"):this.setState({inputVisible:!0},(function(){return e.input.focus()}))}},{key:"handleInputChange",value:function(e){if("questionbank"==this.props.questionbank){if(e.target.value.length>20)return o.default.error("关键词长度不可超过20");var t=e.target.value.split(" ");this.setState({inputValue:t.join("")})}else if(e.target.value.length>10)o.default.error("长度不可超过10个字");else{t=e.target.value.split(" ");this.setState({inputValue:t.join("")})}}},{key:"handleInputConfirm",value:function(){var e=this.props.getTags,t=this.state,a=t.inputValue,l=t.tags;if(!(a.length<21))return o.default.error("长度不可超过20");if(l){var n=[];l.map((function(e,t){""!=(e=e.replace(/\s*/g,""))&&n.push(e)})),l=n}l||(l=[]),a&&-1===l.indexOf(a)&&(l=[].concat((0,s.default)(l),[a])),e&&e(l),this.setState({tags:l,inputVisible:!1,inputValue:""})}},{key:"render",value:function(){var e=this,t=this.state,a=t.tags,l=t.inputVisible,n=t.inputValue;return a||(a=[]),"look"!=this.props.type?_.default.createElement("div",{style:{float:"left"}},l&&_.default.createElement(d.default,{ref:this.saveInputRef,maxLength:"questionbank"==this.props.questionbank?20:10,type:"text",size:"small",style:{width:78,display:this.props.disable?"none":"inline-block"},value:n,onChange:this.handleInputChange,onBlur:this.handleInputConfirm,onPressEnter:this.handleInputConfirm}),!l&&_.default.createElement(i.default,{onClick:this.showInput,style:{background:"#fff",borderStyle:"dashed",display:this.props.disable?"none":"inline-block"}},_.default.createElement(u.default,{type:"plus"})," 添加"),a.map((function(t,a){if(""!=t){var l=(t=t.replace(/\s*/g,"")).length>20,n=_.default.createElement(i.default,{key:t,closable:e.props.disable?a<0:a>=0,onClose:function(){return e.handleClose(t)}},l?"".concat(t.slice(0,20),"..."):t);return l?_.default.createElement(r.default,{title:t,key:t},n):n}}))):_.default.createElement("div",null,a.map((function(e,t){if(""!=e)return e=e.replace(/\s*/g,""),_.default.createElement(i.default,{key:t},e)})))}}]),l}(_.Component);e.exports=v},807:function(e,t,a){"use strict";a.r(t);a(26),a(809),a(655),a(537)},808:function(e,t,a){e.exports=a(11)(815)},809:function(e,t,a){}}]);