(window.webpackJsonp=window.webpackJsonp||[]).push([[61,4],{1016:function(t,e,n){},1412:function(t,e,n){"use strict";var a=n(0);Object.defineProperty(e,"__esModule",{value:!0}),e.postPointSet=function(t,e){return function(n){return(0,i.default)({url:u,data:t}).then((function(t){e&&e(t),console.log(t.data),n({type:"POINT_SET",data:t.data})}))}},e.excl=function(t){return console.log(t),function(e){return(0,i.default)({url:r,data:t}).then((function(t){"1000"==t.code&&o.default.success(t.data)}))}},e.postPointEdit=function(t){return console.log(t),function(e){return(0,i.default)({url:s,data:t}).then((function(t){"1000"==t.code&&o.default.success("保存成功！")}))}},e.getPointTable=function(t){return console.log(t),function(e){return(0,i.default)({url:c,data:t}).then((function(t){e({type:"POINT_TABLE",data:t})}))}},e.postPointShelf=function(t,e,n){return console.log(t),function(e){return(0,i.default)({url:d,data:t}).then((function(t){e({type:"POINT_DETAILED",data:t}),n&&n()}))}},e.postPointShelves=function(t,e,n){return console.log(t),function(e){return(0,i.default)({url:f,data:t}).then((function(t){e({type:"POINT_DETAILED",data:t}),n&&n()}))}},e.postPointAdd=function(t,e,n){return console.log(t),function(e){return(0,i.default)({url:p,data:t}).then((function(t){e({type:"POINT_DETAILED",data:t}),n&&n()}))}},e.postPointModify=function(t,e,n){return console.log(t),function(e){return(0,i.default)({url:h,data:t}).then((function(t){e({type:"POINT_DETAILED",data:t}),n&&n()}))}},e.getPointDetailed=function(t){return console.log(t),function(e){return(0,i.default)({url:v,data:t}).then((function(t){e({type:"POINT_DETAILED",data:t})}))}},e.pointActivityDel=function(t,e){return console.log(t),function(n){return(0,i.default)({url:P,data:t}).then((function(t){e(t)}))}},e.POINT_DETAILED=e.POINT_TABLE=e.POINT_SET=void 0,n(61);var o=a(n(62)),i=a(n(78)),l=a(n(1413));e.POINT_SET="POINT_SET";e.POINT_TABLE="POINT_TABLE";e.POINT_DETAILED="POINT_DETAILED";var u=l.default.postPointSetApi,r=l.default.exclApi,s=l.default.postPointEditApi,c=l.default.getPointTableApi,d=l.default.postPointShelfApi,f=l.default.postPointShelvesApi,p=l.default.postPointAddApi,h=l.default.postPointModifyApi,v=l.default.getPointDetailedApi,P=l.default.pointActivityDelApi},1413:function(t,e,n){"use strict";var a=n(0);Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o=a(n(63)),i={postPointSetApi:"GET ".concat(o.default.webManage,"/point/strategy/view"),exclApi:"POST ".concat(o.default.webManage,"/point/import"),postPointEditApi:"POST ".concat(o.default.webManage,"/point/strategy/update"),getPointTableApi:"GET ".concat(o.default.webManage,"/activity/list"),postPointShelfApi:"POST ".concat(o.default.webManage,"/activity/enabled"),postPointShelvesApi:"POST ".concat(o.default.webManage,"/activity/disabled"),postPointAddApi:"POST ".concat(o.default.webManage,"/activity/insert"),postPointModifyApi:"POST ".concat(o.default.webManage,"/activity/update"),getPointDetailedApi:"GET ".concat(o.default.webManage,"/point/details/list"),pointActivityDelApi:"POST ".concat(o.default.webManage,"/activity/delete")};e.default=i},1800:function(t,e,n){"use strict";var a=n(0);n(3),n(40),n(51),n(20),n(34),n(35),n(23),n(53),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,n(580);var o=a(n(571));n(140);var i=a(n(535));n(99);var l=a(n(100)),u=a(n(98));n(556);var r=a(n(553)),s=a(n(29)),c=a(n(30)),d=a(n(59)),f=a(n(32)),p=a(n(33)),h=a(n(31)),v=a(n(2));n(540);var P=a(n(539)),m=a(n(1)),y=n(52),E=n(561),T=n(1412),A=a(n(226));function g(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}var S=P.default.Item,D=function(t){(0,f.default)(a,t);var e,n=(e=a,function(){var t,n=(0,h.default)(e);if(g()){var a=(0,h.default)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return(0,p.default)(this,t)});function a(t){var e;return(0,s.default)(this,a),e=n.call(this,t),(0,v.default)((0,d.default)(e),"handleSubmit",(function(t){t.preventDefault(),e.props.form.validateFields((function(t,n){t||(e.props.postPointEdit(n),e.state.responseList.length>0&&e.props.excl({ossUrl:e.state.responseList[0].fileUrl}))}))})),e.state={show:!0,uploadAction:"",uploadParams:{},responseList:[],fileList:[]},e.props.gupfetch(),e.beforeUpload=e.beforeUpload.bind((0,d.default)(e)),e.handleUploadChange=e.handleUploadChange.bind((0,d.default)(e)),e}return(0,c.default)(a,[{key:"componentDidMount",value:function(){var t=this;this.props.postPointSet({},(function(e){1e3==e.code&&t.setState({show:1==e.data.state})}))}},{key:"beforeUpload",value:function(t,e){var n=this.props.param;null!==n&&(this.setState({uploadParams:{Filename:n.dir+"/"+t.uid+"."+t.name.split(".")[1],key:n.dir+"/"+t.uid+"."+t.name.split(".")[1],policy:n.policy,OSSAccessKeyId:n.accessid,success_action_status:"200",signature:n.signature},uploadAction:n.host}),this.setState({hostAndDir:n.host+"/"+n.dir,fileList:[]}))}},{key:"handleUploadChange",value:function(t){var e=this,n=t.file,a=t.fileList;if(!/(xls|xlsx)$/g.test(n.name))return message.error("文件类型不对"),!1;var o=this.state.fileList;"removed"==n.status?(o=o.filter((function(t){return t.uid!=n.uid})),this.setState({fileList:o,responseList:o.map((function(t){return{fileName:t.name,fileUrl:t.fileUrl?t.fileUrl:e.state.hostAndDir+"/"+t.uid+"."+t.name.split(".")[1],size:t.size+"",suffix:"."+t.name.split(".")[1]}}))})):(o.push(a.pop()),this.setState({fileList:o.map((function(t){return{uid:t.uid,name:t.name,size:t.size,fileUrl:t.fileUrl}}))}),this.setState({responseList:o.map((function(t){return{fileName:t.name,fileUrl:t.fileUrl?t.fileUrl:e.state.hostAndDir+"/"+t.uid+"."+t.name.split(".")[1],size:t.size+"",suffix:"."+t.name.split(".")[1]}}))}))}},{key:"change",value:function(t){0==t.target.value?this.setState({show:!1}):this.setState({show:!0})}},{key:"render",value:function(){var t=this,e=this.props,n=e.form,a=e.set,s=n.getFieldDecorator,c={labelCol:{xs:{span:24},sm:{span:8}},wrapperCol:{xs:{span:24},sm:{span:8}}},d={wrapperCol:{xs:{span:24,offset:0},sm:{span:16,offset:8}}};return m.default.createElement("div",null,m.default.createElement(A.default,{title:"积分设置"}),m.default.createElement(P.default,{onSubmit:this.handleSubmit},m.default.createElement(S,(0,u.default)({},c,{label:"积分是否启用"}),s("state",{initialValue:a?""+a.state:"1"})(m.default.createElement(r.default.Group,{onChange:function(e){return t.change(e)}},m.default.createElement(r.default,{value:"1"},"启用"),m.default.createElement(r.default,{value:"0"},"不启用")))),this.state.show?m.default.createElement(S,(0,u.default)({},c,{label:"积分导入"}),m.default.createElement("div",null,m.default.createElement(o.default,{headers:{"X-Requested-With":null},fileList:this.state.fileList,action:this.state.uploadAction,data:this.state.uploadParams,beforeUpload:this.beforeUpload,onChange:this.handleUploadChange},m.default.createElement(i.default,null,m.default.createElement(l.default,{type:"upload"})," 导入积分"))),0==this.state.fileList.length?m.default.createElement("div",{style:{color:"#ccc"}},"您还未上传任何数据哦~"):null,m.default.createElement("span",null,"请上传资源附件（附件格式：xls）"),"不知道格式？",m.default.createElement("a",{href:"https://fulan-test.oss-cn-hangzhou.aliyuncs.com/test/积分导入模板.xlsx"},"下载积分模版")):null,m.default.createElement(S,d,m.default.createElement(i.default,{type:"primary",onClick:function(e){return t.handleSubmit(e)}},"保存"))))}}]),a}(m.default.Component),O=P.default.create()(D);var _=(0,y.connect)((function(t,e){return{set:t.point.set,param:t.uploadParam.param}}),(function(t){return{postPointSet:function(e,n){return t((0,T.postPointSet)(e,n))},postPointEdit:function(e){return t((0,T.postPointEdit)(e))},excl:function(e){return t((0,T.excl)(e))},gupfetch:function(){return t((0,E.gupfetch)())}}}))(O);e.default=_},535:function(t,e,n){t.exports=n(11)(70)},539:function(t,e,n){t.exports=n(11)(821)},540:function(t,e,n){"use strict";n.r(e);n(26),n(577),n(584)},553:function(t,e,n){t.exports=n(11)(206)},556:function(t,e,n){"use strict";n.r(e);n(26),n(1016)},561:function(t,e,n){"use strict";var a=n(4),o=n(0);n(44),Object.defineProperty(e,"__esModule",{value:!0}),e.gupList=function(t){return function(e){e({type:u.GET_UPLOAD_LIST,data:t})}},e.gupfetch=function(t,e){var n,a=!1,o=!1;t?(a=t.needTranscode,o=t.type,n="".concat(s,"/upload/policy?needTranscode=").concat(a,"&type=").concat(o,"&date=").concat(new Date)):n="".concat(s,"/upload/policy?date=").concat(new Date);return function(t){return(0,i.default)({url:n}).then((function(n){if("1000"===n.code){var a=JSON.parse(n.data);t({type:u.GET_UPLOAD_PARAM,data:a}),e&&e()}return n}))}},e.upvideo=function(t,e,n){return function(n){return(0,i.default)({videoUpload:c,data:t}).then((function(t){console.log(t.data),"1000"===t.code&&(n({type:u.UP_INFO,data:JSON.parse(t.data)}),e&&e())}))}},e.videoInfo=function(t,e){return function(n){return(0,i.default)({videoPlay:d,data:t}).then((function(t){console.log(t.data),"1000"===t.code&&(n({type:u.VIDEO_INFO,data:t.data}),e&&e())}))}},e.UploadUtilFile=function(t){return{type:u.GET_FILE_NAME_ADDRESS,fileAddress:t}},e.clearUpload=function(){return function(t){t({type:u.CLEARUPLOAD})}};var i=o(n(78)),l=o(n(587)),u=a(n(231)),r=l.default.common,s=r.ossUrl,c=r.videoUpload,d=r.videoPlay},571:function(t,e,n){t.exports=n(11)(912)},577:function(t,e,n){},580:function(t,e,n){"use strict";n.r(e);n(26),n(625),n(598),n(144)},587:function(t,e,n){"use strict";var a=n(0);Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o=a(n(63)),i={common:{ossUrl:"GET ".concat(o.default.ossUrl),videoUpload:"POST ".concat(o.default.ossUrl,"/video/upload"),videoPlay:"GET ".concat(o.default.ossUrl,"/video/play"),ossPolicy:"GET ".concat(o.default.ossUrl,"/upload/policy")}};e.default=i},598:function(t,e,n){"use strict";n.r(e);n(26),n(626)},625:function(t,e,n){},626:function(t,e,n){}}]);