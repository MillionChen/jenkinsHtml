(window.webpackJsonp=window.webpackJsonp||[]).push([[81],{1439:function(e,t,n){e.exports={ClassAdmin:"ClassAdmin__3XwN0",top:"top__1nOFM",weidu:"weidu__2S30H",classTable:"classTable__28bXc",lecturerBasicInfoAddClassify:"lecturerBasicInfoAddClassify__We-Je",addClassifyDisplay:"addClassifyDisplay__1wXv-",addClassifyDisplayItem:"addClassifyDisplayItem__h1aqr"}},2160:function(e,t,n){"use strict";var a=n(4),l=n(0);n(7),n(154),n(5),n(43),n(143),n(51),n(20),n(34),n(23),n(6),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=l(n(98)),r=l(n(238));n(239);var s=l(n(240));n(224);var u=l(n(225));n(549);var c=l(n(544));n(140);var d=l(n(535));n(61);var o=l(n(62)),f=l(n(29)),p=l(n(30)),m=l(n(59)),h=l(n(32)),y=l(n(33)),v=l(n(31)),g=l(n(2));n(540);var k=l(n(539));n(537);var b=l(n(536)),C=a(n(1)),E=n(52),w=l(n(223)),O=l(n(1439)),D=a(n(1317)),x=l(n(226));function R(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function S(e){return function(){var t,n=(0,v.default)(e);if(_()){var a=(0,v.default)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return(0,y.default)(this,t)}}function _(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var j=b.default.TextArea,I=(k.default.Item,{labelCol:{xs:{span:20},sm:{span:6}},wrapperCol:{xs:{span:24},sm:{span:16}}}),M=function(e){(0,h.default)(n,e);var t=S(n);function n(e){var a;return(0,f.default)(this,n),a=t.call(this,e),(0,g.default)((0,m.default)(a),"saveFormRef",(function(e){a.formRef=e})),(0,g.default)((0,m.default)(a),"fnRecursion",(function(e){e&&e.forEach((function(e){e.children=e.children&&0===e.children.length?null:e.children,e.children&&a.fnRecursion(e.children)}))})),a.state={addclass:!1,list:[]},a.initList=a.initList.bind((0,m.default)(a)),a.list=a.list.bind((0,m.default)(a)),a}return(0,p.default)(n,[{key:"componentDidMount",value:function(){this.list()}},{key:"list",value:function(){var e=this,t=this;this.props.classlist().then((function(n){1e3==n.code&&e.setState({list:t.initList(n.data,1),lev:0,id:0})}))}},{key:"initList",value:function(e,t,n){var a=this;if(e&&0!=e.length){return e.map((function(l,i){return l.key=l.id,l.level=t,l.status=l.node.status,l.parentStatus=n||0,l.isTop=0==i,l.isBottom=i==e.length-1,l.children=a.initList(l.children,t+1,l.node.status),l.canDelete=l.children&&l.children.length>0?0:1,l}))}return[]}},{key:"handleOkaddclass",value:function(){var e=this;this.formRef.props.form.validateFields((function(t,n){if(!t)if(e.state.item){var a={classificationDes:n.description,name:n.name,id:e.state.item.id};e.props.classedit(a).then((function(t){1e3==t.code?(o.default.success("修改成功"),e.setState({addclass:!1}),e.list()):o.default.error(t.subMsg)}))}else{var l={classificationDes:n.description,name:n.name,level:e.state.lev,parentId:0==e.state.lev?0:e.state.id};e.props.craeateoneclass(l).then((function(t){1e3==t.code?(o.default.success("添加成功"),e.setState({addclass:!1}),e.list()):o.default.error(t.subMsg)}))}}))}},{key:"handleCanceladdclass",value:function(){this.setState({addclass:!1})}},{key:"add",value:function(e,t){console.log(e,1)}},{key:"addclass",value:function(e,t){this.setState({addclass:!0,id:t,lev:e,item:""})}},{key:"edit",value:function(e){console.log(111,e),this.setState({addclass:!0,item:e});var t=this;this.props.getClassifydesc({id:e.id}).then((function(n){"1000"==n.code?(e.description=n.data.classificationDes,t.setState({item:e})):o.default.error(n.subMsg)}))}},{key:"sort",value:function(e,t){var n={id:e.id,code:1==t?"up":"down"},a=this;this.props.classsort(n).then((function(e){1e3==e.code&&(console.log(e,"res"),o.default.success("移动成功"),a.list()),"4002"!=e.subCode&&"4003"!=e.subCode||o.default.info(e.subMsg)}))}},{key:"upOrDown",value:function(e){var t={id:e.id,status:0==e.status?1:0},n=this;this.props.classUpOrDown(t).then((function(t){"1000"==t.code?(o.default.success(0==e.status?"上架成功":"下架成功"),n.list()):o.default.error(t.subMsg)}))}},{key:"delete",value:function(e){var t=this,n={id:e.id};this.props.classdelete(n).then((function(e){1e3==e.code&&(o.default.success("删除成功"),t.list())}))}},{key:"render",value:function(){var e=this;console.log(1111,this.state.list);var t=[{title:"分类名称",dataIndex:"name",key:"name",render:function(e){return C.default.createElement("span",{title:e},e.length<=15?e:e.slice(0,14)+"...")}},{title:"分类等级",dataIndex:"level",key:"level",render:function(e,t){return C.default.createElement("span",null,2==e?"一级分类":"二级分类")}},{title:"创建时间",dataIndex:"createTime",key:"createTime",render:function(e,t){return C.default.createElement("span",null,(0,w.default)(e).format("YYYY-MM-DD HH:mm:ss"))}},{title:"操作",dataIndex:"id",key:"id",width:"30%",render:function(t,n){return C.default.createElement("div",null,3==n.level?null:C.default.createElement("a",{onClick:function(){return e.addclass(2,t)}},"添加子分类"),C.default.createElement("a",{onClick:function(){return e.edit(n)}},"修改"),n.isTop?"":C.default.createElement("a",{onClick:function(){return e.sort(n,1)}},"上移"),n.isBottom?"":C.default.createElement("a",{onClick:function(){return e.sort(n,2)}},"下移"),1!=n.layer&&0==n.parentStatus?"":0==n.status?C.default.createElement("a",{onClick:function(){return e.upOrDown(n)}},"上架"):C.default.createElement("a",{onClick:function(){return e.upOrDown(n)}},"下架"),0==n.canDelete||0!=n.status?null:C.default.createElement("a",{onClick:function(){return e.delete(n)}},"删除"))}}],n=this.state.list;return this.fnRecursion(n),C.default.createElement("div",{className:O.default.ClassAdmin},C.default.createElement(x.default,{title:"分类管理"}),C.default.createElement("div",{className:O.default.top},C.default.createElement(d.default,{type:"primary",onClick:function(){return e.addclass(0)}},"添加分类")),n&&n.map((function(a,l){return console.log(a.children),C.default.createElement("div",{className:O.default.classTable,key:l},C.default.createElement("div",null,C.default.createElement("span",{style:{marginRight:"13px",fontSize:"20px"}},"按‘",C.default.createElement("span",{style:{color:"blue"},title:a.name},a.name.length<=20?a.name:a.name.slice(0,20)+"..."),"’分类"),C.default.createElement(d.default,{style:{marginRight:"8px"},onClick:function(){return e.addclass(1,a.id)},type:"primary"},"添加子分类"),C.default.createElement(d.default,{style:{marginRight:"8px"},type:"primary",onClick:function(){return e.edit(a)}},"修改"),C.default.createElement(d.default,{type:"primary",style:{marginRight:"8px"},onClick:function(){return e.delete(a)},disabled:!!(a.children&&a.children.length>0)},"删除"),C.default.createElement(d.default,{style:{marginRight:"8px"},type:"primary",onClick:function(){return e.sort(a.node,1)},disabled:0==l},"上移"),C.default.createElement(d.default,{style:{marginRight:"8px"},type:"primary",onClick:function(){return e.sort(a.node,2)},disabled:l==n.length-1},"下移"),0==a.node.status?C.default.createElement(d.default,{style:{marginRight:"8px"},type:"primary",onClick:function(){return e.upOrDown(a.node)}},"上架"):C.default.createElement(d.default,{style:{marginRight:"8px"},type:"primary",onClick:function(){return e.upOrDown(a.node)}},"下架")),C.default.createElement(c.default,{columns:t,defaultExpandAllRows:!0,dataSource:a.children,pagination:!1}))})),C.default.createElement(u.default,{width:600,title:"添加分类",visible:this.state.addclass,onOk:this.handleOkaddclass.bind(this),onCancel:this.handleCanceladdclass.bind(this),destroyOnClose:1},C.default.createElement(P,{item:this.state.item,wrappedComponentRef:this.saveFormRef})))}}]),n}(C.Component),P=k.default.create()(function(e){(0,h.default)(n,e);var t=S(n);function n(e){var a;return(0,f.default)(this,n),(a=t.call(this,e)).state={name:""},a.onChange=a.onChange.bind((0,m.default)(a)),a}return(0,p.default)(n,[{key:"componentDidMount",value:function(){var e=this.props.item;this.setState({name:e.name})}},{key:"onChange",value:function(e){var t=e.target.value;t.length>20&&(t=t.slice(0,20)),this.setState({name:t}),this.props.form.setFieldsValue({name:t})}},{key:"render",value:function(){var e="",t=this.props,n=t.form,a=t.item,l=n.getFieldDecorator;e=a||"";var u;return C.default.createElement("div",null,C.default.createElement(k.default,null,C.default.createElement(k.default.Item,(0,i.default)({label:"分类名称"},I),l("name",{rules:[{required:!0,message:"分类名称不可为空"},{validator:(u=(0,s.default)(r.default.mark((function e(t,n){return r.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n.length>20)){e.next=2;break}throw new Error("不能超过20个字");case 2:case"end":return e.stop()}}),e)}))),function(e,t){return u.apply(this,arguments)})}],initialValue:this.state.name})(C.default.createElement(b.default,{placeholder:"请输入分类名称",onChange:this.onChange}))),C.default.createElement(k.default.Item,(0,i.default)({label:"分类描述"},I),l("description",{initialValue:e?e.description:"",rules:[{max:200,message:"最多输入200个字"}]})(C.default.createElement(j,{placeholder:"请输入子分类描述",maxLength:201,rows:4})))))}}]),n}(C.Component)),T=(0,E.connect)(null,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?R(Object(n),!0).forEach((function(t){(0,g.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):R(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},D))(M);t.default=T},537:function(e,t,n){"use strict";n.r(t);n(26),n(586),n(140)},586:function(e,t,n){}}]);