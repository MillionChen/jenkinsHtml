(window.webpackJsonp=window.webpackJsonp||[]).push([[93,4],{1407:function(e,t,a){e.exports={offline_course_body:"offline_course_body__oY7rx",head_search:"head_search__2eiv0",head_btns:"head_btns__18pQO",head_btn_del:"head_btn_del__1RFMc",course_detail_body:"course_detail_body__djFx9",upload_body:"upload_body__1SiTs"}},1408:function(e,t,a){"use strict";var n=a(4),l=a(0);a(51),Object.defineProperty(t,"__esModule",{value:!0}),t.getCourseList=y,t.getSortList=function(e,t){return function(t){return(0,r.default)({url:h,data:e}).then((function(e){if("1000"===e.code){for(var a=e.data,n=[],l=0;l<a.length;l++)1===a[l].layer&&n.push({label:a[l].name,title:a[l].name,value:a[l].id,id:a[l].id,key:"A"+l,code:a[l].code,name:a[l].name,level:"一级分类",createTime:a[l].createTime}),2===a[l].layer&&("children"in n[n.length-1]||(n[n.length-1].children=[]),n[n.length-1].children.push({label:a[l].name,title:a[l].name,value:a[l].id,id:a[l].id,key:"B"+l,code:a[l].code,name:a[l].name,level:"二级分类",createTime:a[l].createTime})),3===a[l].layer&&("children"in n[n.length-1].children[n[n.length-1].children.length-1]||(n[n.length-1].children[n[n.length-1].children.length-1].children=[]),n[n.length-1].children[n[n.length-1].children.length-1].children.push({label:a[l].name,title:a[l].name,value:a[l].id,id:a[l].id,key:""+l,code:a[l].code,name:a[l].name,level:"三级分类",createTime:a[l].createTime}));console.log(n),t({type:i.OFFLINE_CLASSIFY_LIST,data:n})}else o.default.error(e.subMsg)}))}},t.upCourse=function(e,t,a){return function(a){return(0,r.default)({url:c,data:e}).then((function(e){"1000"===e.code?a(y(t)):o.default.error(e.subMsg)}))}},t.downCourse=function(e,t,a){return function(a){return(0,r.default)({url:f,data:e}).then((function(e){"1000"===e.code?a(y(t)):o.default.error(e.subMsg)}))}},t.deleteCourse=function(e,t,a){return function(a){return(0,r.default)({url:p,data:e}).then((function(e){"1000"===e.code?a(y(t)):o.default.error(e.subMsg)}))}},t.getCourseInfo=function(e,t){return function(a){return(0,r.default)({url:m,data:{id:e}}).then((function(e){"1000"===e.code?(a({type:i.OFFLINE_COURSE_INFO,data:e.data}),t&&t(e)):o.default.error(e.subMsg)}))}},t.courseBasicInfo=function(e,t){return function(a){return(0,r.default)({url:g,data:e}).then((function(e){"1000"===e.code?t&&t():o.default.error(e.subMsg)}))}},t.saveCourseBasicInfo=function(e,t){return function(a){return(0,r.default)({url:v,data:e}).then((function(e){"1000"===e.code?t&&t():o.default.error(e.subMsg)}))}},t.uploadData=function(e,t){return function(a){return(0,r.default)({url:U,data:e}).then((function(e){"1000"===e.code?t&&t(e):o.default.error(e.subMsg)}))}},t.resetCourseInfo=void 0,a(61);var o=l(a(62)),r=l(a(78)),u=l(a(1409)),i=n(a(269)),s=u.default.offlineCourse,d=s.courseListUrl,c=s.courseUpUrl,f=s.courseDownUrl,p=s.courseDelUrl,h=s.classifyListUrl,m=s.courseDetailUrl,g=s.courseSaveUrl,v=s.courseUpdateUrl,U=s.courseUploadUrl;function y(e,t){return function(a){return(0,r.default)({url:d,data:e}).then((function(e){"1000"===e.code?(a({type:i.OFFLINE_COURSE_LIST,data:e.data}),t&&t(e)):o.default.error(e.subMsg)}))}}t.resetCourseInfo=function(){return function(e){e({type:COURSEINFO,data:{data:{}}})}}},1409:function(e,t,a){"use strict";var n=a(0);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=n(a(63)),o={offlineCourse:{courseListUrl:"GET ".concat(l.default.webManage,"/offlineCourse/list"),courseUpUrl:"POST ".concat(l.default.webManage,"/offlineCourse/up/"),courseDownUrl:"POST ".concat(l.default.webManage,"/offlineCourse/down"),courseDelUrl:"POST ".concat(l.default.webManage,"/offlineCourse/delete"),classifyListUrl:"POST ".concat(l.default.webManage,"/offlineClassify/list"),courseDetailUrl:"GET ".concat(l.default.webManage,"/offlineCourse/get"),courseSaveUrl:"POST ".concat(l.default.webManage,"/offlineCourse/save"),courseUpdateUrl:"POST ".concat(l.default.webManage,"/offlineCourse/update"),courseUploadUrl:"POST ".concat(l.default.webManage,"/offlineCourse/upload")}};t.default=o},1693:function(e,t,a){"use strict";var n=a(4),l=a(0);a(3),a(40),a(51),a(20),a(34),a(35),a(23),a(53),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=l(a(98));a(580);var r=l(a(571));a(140);var u=l(a(535));a(99);var i=l(a(100));a(61);var s=l(a(62)),d=l(a(29)),c=l(a(30)),f=l(a(59)),p=l(a(32)),h=l(a(33)),m=l(a(31));a(540);var g=l(a(539)),v=n(a(1)),U=a(561),y=a(52),_=l(a(1407)),b=a(1408),S=a(65),L=l(a(106));function O(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var C=g.default.Item,E={labelCol:{span:4},wrapperCol:{span:20}};var M=function(e){(0,p.default)(n,e);var t,a=(t=n,function(){var e,a=(0,m.default)(t);if(O()){var n=(0,m.default)(this).constructor;e=Reflect.construct(a,arguments,n)}else e=a.apply(this,arguments);return(0,h.default)(this,e)});function n(e){var t;return(0,d.default)(this,n),(t=a.call(this,e)).state={fileList:[],uploadAction:"",uploadParams:{},responseList:[],text:{}},t.props.gupfetch(),t.beforeUpload=t.beforeUpload.bind((0,f.default)(t)),t.handleUploadChange=t.handleUploadChange.bind((0,f.default)(t)),t}return(0,c.default)(n,[{key:"componentDidMount",value:function(){var e=this;this.props.location.state&&this.setState({text:JSON.parse(this.props.location.state.text)},(function(){e.state.text.ossUrl&&e.state.text.fileName&&e.setState({fileList:[{fileUrl:e.state.text.ossUrl,name:e.state.text.fileName,size:"",uid:e.state.text.id}],responseList:[{fileUrl:e.state.text.ossUrl,fileName:e.state.text.fileName,size:"",uid:e.state.text.id}]})}))}},{key:"beforeUpload",value:function(e,t){var a=this.props.param;null!==a&&(this.setState({uploadParams:{Filename:a.dir+"/"+e.uid+"."+e.name.split(".")[1],key:a.dir+"/"+e.uid+"."+e.name.split(".")[1],policy:a.policy,OSSAccessKeyId:a.accessid,success_action_status:"200",signature:a.signature},uploadAction:a.host}),this.setState({hostAndDir:a.host+"/"+a.dir,fileList:[]}))}},{key:"handleUploadChange",value:function(e){var t=this,a=e.file,n=e.fileList;if(!/(xls|xlsx)$/g.test(a.name))return s.default.error(L.default.get("test151")||"文件类型不对"),!1;var l=this.state.fileList;"removed"==a.status?(l=l.filter((function(e){return e.uid!=a.uid})),this.setState({fileList:l,responseList:l.map((function(e){return{fileName:e.name,fileUrl:e.fileUrl?e.fileUrl:t.state.hostAndDir+"/"+e.uid+"."+e.name.split(".")[1],size:e.size+"",suffix:"."+e.name.split(".")[1]}}))})):(l.push(n.pop()),this.setState({fileList:l.map((function(e){return{uid:e.uid,name:e.name,size:e.size,fileUrl:e.fileUrl}}))}),this.setState({responseList:l.map((function(e){return{fileName:e.name,fileUrl:e.fileUrl?e.fileUrl:t.state.hostAndDir+"/"+e.uid+"."+e.name.split(".")[1],size:e.size+"",suffix:"."+e.name.split(".")[1]}}))}))}},{key:"upload",value:function(){if(this.state.fileList.length>0){var e={id:this.state.text.id,fileName:this.state.responseList[0].fileName,ossUrl:this.state.responseList[0].fileUrl};this.props.uploadData(e,(function(e){s.default.success(e.data),history.back()}),300)}else s.default.error(L.default.get("albumManagement72")||"请先上传文件")}},{key:"uploadup",value:function(){if(this.state.fileList.length>0){var e={id:this.state.text.id,fileName:this.state.responseList[0].fileName,ossUrl:this.state.responseList[0].fileUrl,up:1};this.props.uploadData(e,(function(e){s.default.success(e.data),history.back()}),300)}else s.default.error(L.default.get("albumManagement72")||"请先上传文件")}},{key:"render",value:function(){var e=this,t=this.props.form.getFieldDecorator;console.log("this.state=upload=",this.state),console.log("this.props=upload=",this.props);var a="";return a=0===this.state.fileList.length?"newState":"editState",v.default.createElement("div",{id:"underline",className:_.default.upload_body},v.default.createElement("div",{style:{padding:10,color:"#ccc"}},L.default.get("ReportingManage39")||"请确保上传文件格式正确，且数据无遗漏"),v.default.createElement(C,(0,o.default)({label:L.default.get("QiandaoStatisitic10")||"导入数据"},E),t("file")(v.default.createElement("div",{className:"cred-edit-logo","data-status":a},v.default.createElement(r.default,{headers:{"X-Requested-With":null},fileList:this.state.fileList,action:this.state.uploadAction,data:this.state.uploadParams,beforeUpload:this.beforeUpload,onChange:this.handleUploadChange},v.default.createElement(u.default,null,v.default.createElement(i.default,{type:"upload"})," ",L.default.get("UploadAttachment")||"上传附件")))),0==this.state.fileList.length?v.default.createElement("div",{style:{color:"#ccc"}},L.default.get("SystemOption10")||"您还未上传任何数据哦","~"):null,v.default.createElement("span",null,L.default.get("SystemOption11")||"请上传资源附件（附件格式：xls）"),L.default.get("SystemOption12")||"不知道格式？",v.default.createElement("a",{href:"http://cloud-wmy.oss-cn-shanghai.aliyuncs.com/wmy/线下课程导入模板.xlsx"},L.default.get("QiandaoStatisitic21")||"下载Excel数据模版")),"            ",v.default.createElement(u.default,{onClick:function(){return e.upload()}},L.default.get("Upload")||"上传"),"        ",v.default.createElement(u.default,{onClick:function(){return e.uploadup()}},L.default.get("albumManagement73")||"上传并发布"))}}]),n}(v.Component),x=g.default.create()(M),T=(0,y.connect)((function(e,t){return{param:e.uploadParam.param}}),(function(e){return{gupfetch:function(){return e((0,U.gupfetch)())},uploadData:function(t,a){return e((0,b.uploadData)(t,a))}}}))((0,S.withRouter)(x));t.default=T},535:function(e,t,a){e.exports=a(11)(70)},539:function(e,t,a){e.exports=a(11)(821)},540:function(e,t,a){"use strict";a.r(t);a(26),a(577),a(584)},561:function(e,t,a){"use strict";var n=a(4),l=a(0);a(44),Object.defineProperty(t,"__esModule",{value:!0}),t.gupList=function(e){return function(t){t({type:u.GET_UPLOAD_LIST,data:e})}},t.gupfetch=function(e,t){var a,n=!1,l=!1;e?(n=e.needTranscode,l=e.type,a="".concat(s,"/upload/policy?needTranscode=").concat(n,"&type=").concat(l,"&date=").concat(new Date)):a="".concat(s,"/upload/policy?date=").concat(new Date);return function(e){return(0,o.default)({url:a}).then((function(a){if("1000"===a.code){var n=JSON.parse(a.data);e({type:u.GET_UPLOAD_PARAM,data:n}),t&&t()}return a}))}},t.upvideo=function(e,t,a){return function(a){return(0,o.default)({videoUpload:d,data:e}).then((function(e){console.log(e.data),"1000"===e.code&&(a({type:u.UP_INFO,data:JSON.parse(e.data)}),t&&t())}))}},t.videoInfo=function(e,t){return function(a){return(0,o.default)({videoPlay:c,data:e}).then((function(e){console.log(e.data),"1000"===e.code&&(a({type:u.VIDEO_INFO,data:e.data}),t&&t())}))}},t.UploadUtilFile=function(e){return{type:u.GET_FILE_NAME_ADDRESS,fileAddress:e}},t.clearUpload=function(){return function(e){e({type:u.CLEARUPLOAD})}};var o=l(a(78)),r=l(a(587)),u=n(a(231)),i=r.default.common,s=i.ossUrl,d=i.videoUpload,c=i.videoPlay},571:function(e,t,a){e.exports=a(11)(912)},577:function(e,t,a){},580:function(e,t,a){"use strict";a.r(t);a(26),a(625),a(598),a(144)},587:function(e,t,a){"use strict";var n=a(0);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=n(a(63)),o={common:{ossUrl:"GET ".concat(l.default.ossUrl),videoUpload:"POST ".concat(l.default.ossUrl,"/video/upload"),videoPlay:"GET ".concat(l.default.ossUrl,"/video/play"),ossPolicy:"GET ".concat(l.default.ossUrl,"/upload/policy")}};t.default=o},598:function(e,t,a){"use strict";a.r(t);a(26),a(626)},625:function(e,t,a){},626:function(e,t,a){}}]);