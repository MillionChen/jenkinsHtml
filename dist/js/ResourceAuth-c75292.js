(window.webpackJsonp=window.webpackJsonp||[]).push([[110],{1535:function(e,t,a){"use strict";var r=a(4),n=a(0);a(44),a(20),a(34),a(23),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=n(a(98));a(592);var o=n(a(566)),s=n(a(29)),i=n(a(30)),u=n(a(59)),c=n(a(32)),d=n(a(33)),f=n(a(31)),p=n(a(2));a(556);var m=n(a(553));a(540);var h=n(a(539)),y=r(a(1)),v=n(a(223));function g(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var S=h.default.Item,C=m.default.Group,D=function(e){(0,c.default)(r,e);var t,a=(t=r,function(){var e,a=(0,f.default)(t);if(g()){var r=(0,f.default)(this).constructor;e=Reflect.construct(a,arguments,r)}else e=a.apply(this,arguments);return(0,d.default)(this,e)});function r(){var e;(0,s.default)(this,r);for(var t=arguments.length,n=new Array(t),l=0;l<t;l++)n[l]=arguments[l];return e=a.call.apply(a,[this].concat(n)),(0,p.default)((0,u.default)(e),"state",{ids:[]}),(0,p.default)((0,u.default)(e),"onTimeModal",(function(){e.setState({timeModal:!0})})),e}return(0,i.default)(r,[{key:"render",value:function(){var e=this.props.data,t=(e=void 0===e?{}:e).expireDate,a=e.parentUseDuration,r=this.props.form.getFieldDecorator,n={labelCol:{xs:{span:4},sm:{span:6}},wrapperCol:{xs:{span:12},sm:{span:14}}};return y.default.createElement(h.default,null,y.default.createElement(S,(0,l.default)({},n,{label:"设置有效期:"}),r("useType",{initialValue:t?"1":"0",rules:[{required:!0,message:"请选择有效期"}]})(y.default.createElement(C,null,y.default.createElement("div",null,y.default.createElement(m.default,{value:"0",disabled:!!a},"长期有效")),y.default.createElement("div",null,y.default.createElement(m.default,{value:"1"},"固定失效日期:",y.default.createElement("div",{style:{position:"absolute",left:"116px",top:"-8px",width:"330px"}},y.default.createElement(S,(0,l.default)({label:""},n),r("useDuration",{initialValue:t?(0,v.default)(t):null})(y.default.createElement(o.default,{className:"cred-edit-radio-datePicker",size:"small",placeholder:"请选择日期",disabledDate:function(e){return!!a&&e>=a}}))))))))))}}]),r}(y.Component),b=h.default.create()(D);t.default=b},1767:function(e,t,a){"use strict";var r=a(4),n=a(0);a(7),a(3),a(5),a(43),a(51),a(9),a(10),a(8),a(20),a(34),a(23),a(6),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a(224);var l=n(a(225)),o=n(a(98));a(549);var s=n(a(544));a(140);var i=n(a(535)),u=n(a(29)),c=n(a(30)),d=n(a(59)),f=n(a(32)),p=n(a(33)),m=n(a(31)),h=n(a(2));a(554);var y=n(a(550)),v=n(a(1)),g=a(52),S=n(a(226)),C=r(a(1318)),D=n(a(1768)),b=n(a(1772));function E(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function O(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?E(Object(a),!0).forEach((function(t){(0,h.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):E(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function w(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var I=y.default.Option,R=function(e){(0,f.default)(r,e);var t,a=(t=r,function(){var e,a=(0,m.default)(t);if(w()){var r=(0,m.default)(this).constructor;e=Reflect.construct(a,arguments,r)}else e=a.apply(this,arguments);return(0,p.default)(this,e)});function r(e){var t;return(0,u.default)(this,r),t=a.call(this,e),(0,h.default)((0,d.default)(t),"insertModal",(function(e){t.setState({insertFlag:!0,visible:!0,updateFlag:!1,title:e})})),(0,h.default)((0,d.default)(t),"editModal",(function(e,a){var r;t.setState((r={insertFlag:!1,visible:!0,updateFlag:!0,title:e,siteId:a.siteId,record:a,type:"edit"},(0,h.default)(r,"title",e),(0,h.default)(r,"width","30rem"),(0,h.default)(r,"key",Math.random()),r))})),(0,h.default)((0,d.default)(t),"handleGetValue",(function(e){t.setState({value:e.target.value})})),(0,h.default)((0,d.default)(t),"handleGetSiteValue",(function(e){t.setState({siteName:e.target.value})})),(0,h.default)((0,d.default)(t),"handleSearch",(function(){var e=t.state,a=e.value,r=e.siteName;t.setState({name:a,siteName:r},(function(){var e=t.props.getCourseSale,a=t.state,r={companyName:a.name,siteName:a.siteName,pageNo:1,pageSize:10,type:"1"};r.companyName||delete r.companyName,r.siteName||delete r.siteName,e(r)}))})),(0,h.default)((0,d.default)(t),"hideModal",(function(){t.setState({visible:!1}),t.props.selectCoursRest()})),(0,h.default)((0,d.default)(t),"onRefresh",(function(){console.log("刷新页面");var e=t.props.courseSale.courseSaleData,a=e.pageNo,r=e.pageSize,n=t.state,l=n.name,o=n.siteName,s=t.props.getCourseSale,i={companyName:l,siteName:o,pageNo:a,pageSize:r,type:"1"};i.companyName||delete i.companyName,i.siteName||delete i.siteName,s(i)})),t.state={searchName:"",editeData:[],data:{},title:"",name:"",code:""},t.columns=[{title:"序号",dataIndex:"key",key:"key"},{title:"站点名称",dataIndex:"siteName",key:"siteName",render:function(e){return v.default.createElement("span",{title:e},e.length>10?e.substring(9,0)+"...":e)}},{title:"授权课程总数",dataIndex:"authorizeCount",key:"authorizeCount"},{title:"有效课程数",dataIndex:"validCourseCount",key:"validCourseCount"},{title:"操作",key:"action",render:function(e,a){return v.default.createElement("a",{onClick:function(){return t.editModal("编辑",a)}},"编辑")}}],t}return(0,c.default)(r,[{key:"componentDidMount",value:function(){this.props.getCourseSale({pageNo:1,pageSize:10,type:"1"}),this.props.getAuthSiteList()}},{key:"render",value:function(){var e,t=this,a=this.props.courseSale,r=[];if(a.courseSaleData){var n=a.courseSaleData,u=n.pageNo,c=n.pageSize;this.props.courseSale.courseSaleData.records.map((function(e,t){r.push(O({},e,{key:t+1+c*(u-1)}))})),e=a.courseSaleData}var d=this.state.siteName,f={showQuickJumper:!0,showSizeChanger:!0,pageSizeOptions:["10","50","100"],total:e?e.pageRecords:null,showTotal:function(e){return"共计 ".concat(e," 条")},PageSize:e?e.pageSize:null,current:e?e.pageNo:null,onShowSizeChange:function(e,a){t.props.getCourseSale({siteName:d,pageNo:e,pageSize:a,type:"1"}),t.setState({pageNo:1})},onChange:function(e,a){t.props.getCourseSale({siteName:d,pageNo:e,pageSize:a,type:"1"})}},p=this.props.singleSite.authData,m=void 0===p?[]:p;return v.default.createElement("div",{className:"list",style:{paddingLeft:"20px"}},v.default.createElement(S.default,{title:"资源授权管理"}),v.default.createElement("div",{className:"list-btn"},v.default.createElement("div",{ref:function(e){return t.input=e}},v.default.createElement("span",null,"站点名称："),v.default.createElement(y.default,{style:{width:250},defaultValue:"",onSelect:function(e){return t.setState({siteName:e})}},v.default.createElement(I,{key:0,value:""},"请选择站点"),m.map((function(e){return v.default.createElement(I,{key:e.id,value:e.name},e.name)}))),v.default.createElement(i.default,{type:"primary",onClick:this.handleSearch,style:{marginRight:10,marginLeft:10}},"查询"),v.default.createElement(i.default,{type:"primary",onClick:function(){return t.insertModal("新增授权")}},"新增授权"))),v.default.createElement(s.default,{columns:this.columns,dataSource:r,pagination:f,rowKey:function(e){return e.id}}),v.default.createElement(l.default,{key:this.state.key,title:this.state.title,visible:this.state.visible,onOk:this.hideModal,afterClose:this.onRefresh,destroyOnClose:1,maskClosable:0,onCancel:this.hideModal,footer:!1,width:1100},this.state.insertFlag?v.default.createElement("div",null,v.default.createElement(D.default,{onCancel:this.hideModal,handleSearch:this.handleSearch,onRefresh:this.onRefresh})):null,this.state.updateFlag?v.default.createElement("div",null,v.default.createElement(b.default,(0,o.default)({siteId:this.state.siteId},this.state.record,{onRefresh:this.onRefresh}))):null))}}]),r}(v.default.Component),k=(0,g.connect)((function(e){return O({},e)}),O({},C.default))(R);t.default=k},1768:function(e,t,a){"use strict";var r=a(4),n=a(0);a(44),a(3),a(103),a(43),a(51),a(20),a(34),a(23),a(905),a(148),a(151),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=n(a(79));a(61);var o=n(a(62)),s=n(a(29)),i=n(a(30)),u=n(a(59)),c=n(a(32)),d=n(a(33)),f=n(a(31)),p=n(a(2));a(540);var m=n(a(539));a(554);var h=n(a(550)),y=r(a(1)),v=n(a(1769)),g=a(52),S=r(a(1318)),C=n(a(223));function D(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function b(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?D(Object(a),!0).forEach((function(t){(0,p.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):D(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function E(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}a(1771);var O=h.default.Option,w=m.default.Item,I=function(e){(0,c.default)(r,e);var t,a=(t=r,function(){var e,a=(0,f.default)(t);if(E()){var r=(0,f.default)(this).constructor;e=Reflect.construct(a,arguments,r)}else e=a.apply(this,arguments);return(0,d.default)(this,e)});function r(){var e;(0,s.default)(this,r);for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return e=a.call.apply(a,[this].concat(n)),(0,p.default)((0,u.default)(e),"state",{value:"",course:[],flag:!1}),(0,p.default)((0,u.default)(e),"onSelectSites",(function(t){var a=e.props.courseSale.enterprise,r=void 0===a?[]:a;r=r.filter((function(e){return e.name===t}))[0],e.props.selectSite({companyId:r.id}),e.setState({companyName:r.name,companyId:r.id}),e.props.selectEnterpriseCourse({companyId:r.id})})),(0,p.default)((0,u.default)(e),"onSelectSite",(function(t,a){e.setState({siteId:t,siteName:a.props.children}),t?e.props.selectEnterpriseCourse({csiteId:t}):e.props.selectEnterpriseCoursRest()})),(0,p.default)((0,u.default)(e),"onChangeSite",(function(t){t||e.props.selectEnterpriseCoursRest()})),(0,p.default)((0,u.default)(e),"onSetTime",(function(e){console.log("设置时间---add",e)})),(0,p.default)((0,u.default)(e),"onAuth",(function(){e.props.form.validateFieldsAndScroll((function(t,a){if(!t){console.log("Received values of form: ",a);var r=e.state,n=r.companyId,s=r.companyName,i=r.siteId,u=r.siteName;e.authorize.getForm().validateFields((function(t,a){console.log("字符串数据 ",a);var r=a.useType,c=a.useDuration,d=e.state.courseIds;if(d){var f={courseIds:(0,l.default)(new Set(d)),accreditVO:{companyId:n,companyName:s,siteId:i,siteName:u,useDuration:c?(0,C.default)(c).format("YYYY-MM-DD"):"",useType:r,saleAuthorizeStatus:0,type:1}};console.log(f),e.props.authorize(f,(function(){e.props.onCancel(),e.props.handleSearch()}))}else o.default.error("请添加课程")}))}}))})),(0,p.default)((0,u.default)(e),"onAuth2",(function(t){e.setState({courseIds:t}),e.props.form.validateFieldsAndScroll((function(a,r){if(!a){console.log("Received values of form: ",r);var n=e.state,l=(n.companyId,n.companyName,n.siteId),s=n.siteName;e.authorize.getForm().validateFields((function(a,r){var n=r.useType,i=r.useDuration;if(t){var u={authorizationCourseVOs:t.map((function(e){return{courseId:e,validDate:null}})),accreditVO:{siteId:l,siteName:s,useDuration:i?(0,C.default)(i).format("YYYY-MM-DD"):"",useType:n,saleAuthorizeStatus:0,type:1}};console.log(u),e.props.authorize(u,(function(){e.props.handleSearch()}))}else o.default.error("请添加课程")}))}}))})),e}return(0,i.default)(r,[{key:"componentDidMount",value:function(){this.props.getAuthSiteList()}},{key:"render",value:function(){var e=this,t=this.props.form.getFieldDecorator,a=this.props.singleSite.authData,r=void 0===a?[]:a;return y.default.createElement("div",{className:"auth"},y.default.createElement(m.default,null,y.default.createElement("div",{style:{display:"flex"}},y.default.createElement(w,{label:"选择站点",labelCol:{span:4},wrapperCol:{span:17},style:{marginLeft:"30px",width:"600px"}},t("site",{rules:[{required:!0,message:"请选择站点"}],initialValue:name})(y.default.createElement(h.default,{style:{width:"200px"},allowClear:!0,onSelect:this.onSelectSite,onChange:this.onChangeSite},y.default.createElement(O,{key:0,value:""},"请选择站点"),r.map((function(e){return y.default.createElement(O,{key:e.id,value:e.id},e.name)})))))),y.default.createElement(w,{label:"",labelCol:{span:3},wrapperCol:{span:5},style:{marginLeft:"30px"}},t("course",{})(y.default.createElement(v.default,{ref:function(t){return e.authorize=t},selectCourse:this.props.selectCourse,selectCourseData:this.props.courseSale.selectCourseData,selectCoursRest:this.props.selectCoursRest,selectEnterprise:function(t){return e.props.selectEnterprise(t)},enterprise:this.props.courseSale.enterprise,selectSite:this.props.selectSite,sites:this.props.courseSale.sites,getSortList:this.props.getSortList,sortlist:this.props.courseSale.list,selectEnterpriseCourse:this.props.selectEnterpriseCourse,selectEnterpriseCourseRest:this.props.selectEnterpriseCourseRest,selectEnterpriseCourseData:this.props.courseSale.selectEnterpriseCourseData,companyId:this.state.companyId,getSelectCourse:this.onAuth2,onSetTime:this.onSetTime,updateValidDate:this.props.updateValidDate,onRefresh:this.props.onRefresh,siteId:this.state.siteId,siteName:this.state.siteName})))))}}]),r}(y.Component),R=(0,g.connect)((function(e){return b({},e)}),b({},S.default))(m.default.create()(I));t.default=R},1769:function(e,t,a){"use strict";var r=a(4),n=a(0);a(44),a(3),a(159),a(82),a(43),a(51),a(20),a(34),a(35),a(23),a(84),a(229),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a(224);var l=n(a(225));a(540);var o=n(a(539));a(549);var s=n(a(544));a(574);var i=n(a(565));a(140);var u=n(a(535));a(99);var c=n(a(100));a(61);var d=n(a(62)),f=n(a(79)),p=n(a(29)),m=n(a(30)),h=n(a(59)),y=n(a(32)),v=n(a(33)),g=n(a(31)),S=n(a(2)),C=r(a(1)),D=n(a(1770)),b=n(a(1535)),E=n(a(223));function O(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var w=function(e){(0,y.default)(r,e);var t,a=(t=r,function(){var e,a=(0,g.default)(t);if(O()){var r=(0,g.default)(this).constructor;e=Reflect.construct(a,arguments,r)}else e=a.apply(this,arguments);return(0,v.default)(this,e)});function r(){var e;(0,p.default)(this,r);for(var t=arguments.length,n=new Array(t),l=0;l<t;l++)n[l]=arguments[l];return e=a.call.apply(a,[this].concat(n)),(0,S.default)((0,h.default)(e),"state",{selectCourses:[],ids:[],selectedRows:[],selectedRowKeys:[],editVo:void 0}),(0,S.default)((0,h.default)(e),"onSelectCourse",(function(t,a){e.setState({ids:[].concat((0,f.default)(t),(0,f.default)(e.state.ids)),selectCourses:[].concat((0,f.default)(a),(0,f.default)(e.state.selectCourses))},(function(){return e.props.getSelectCourse(e.state.ids)}))})),(0,S.default)((0,h.default)(e),"handleSearchSelect",(function(t){e.props.selectEnterpriseCourse({classifyId:t,companyId:e.props.companyId})})),(0,S.default)((0,h.default)(e),"searchCourse",(function(){var t=e.props.form.getFieldValue("classifyId"),a=e.props.form.getFieldValue("name");e.props.selectCourse({classifyId:t,name:a})})),(0,S.default)((0,h.default)(e),"searchEnterpriseCourse",(function(){var t=e.props.form.getFieldValue("classifyId"),a=e.props.form.getFieldValue("name");e.props.selectEnterpriseCourse({classifyId:t,companyId:e.props.companyId,name:a}),e.setState({targetKeys:[]})})),(0,S.default)((0,h.default)(e),"onTimeModal",(function(t){console.log("===================================="),console.log(t),console.log("===================================="),e.setState({timeModal:!0,editVo:t})})),(0,S.default)((0,h.default)(e),"onSetTime",(function(){console.log("设置时间"),e.timeModalRef.validateFields((function(t,a){if(!t){console.log("Received values of form: ",a);var r=e.state,n=(r.companyId,r.companyName,r.siteId,r.siteName,r.editVo),l=r.selectCourses,o=r.selectedRowKeys;e.props.onSetTime(a),e.setState({timeModal:!1}),console.log("===================================="),console.log(n),console.log("====================================");var s=e.props.selectEnterpriseCourseData,i=[].concat((0,f.default)(l),(0,f.default)(s));if(n){var u=i.find((function(e){return e.id==n.id}));"0"===a.useType?u.expireDate=null:u.expireDate=(0,E.default)(a.useDuration).format("YYYY-MM-DD");var c={authorizationCourseVOs:[{courseId:n.id,validDate:"0"===a.useType?null:(0,E.default)(a.useDuration).valueOf()}]};e.props.updateValidDate(c)}else{var d={authorizationCourseVOs:s.filter((function(e){return o.includes(e.id)})).map((function(e){return{courseId:e.id,validDate:"0"===a.useType?null:(0,E.default)(a.useDuration).valueOf()}}))};e.props.updateValidDate(d,(function(){i.map((function(e){o.includes(e.id)&&(e.expireDate="0"===a.useType?null:(0,E.default)(a.useDuration).format("YYYY-MM-DD"))})),e.setState({selectEnterpriseCourseData:i})}))}}}))})),(0,S.default)((0,h.default)(e),"onBatchSetTime",(function(){var t=e.state;t.selectCourses;0!==t.selectedRowKeys.length?e.setState({timeModal:!0,editVo:void 0}):d.default.warning("请选择课程")})),(0,S.default)((0,h.default)(e),"onDelete",(function(){var t=e.state,a=t.selectCourses,r=t.selectedRowKeys;0!==r.length?e.setState({selectCourses:a.filter((function(e){return!r.includes(e.id)})),selectedRowKeys:[]}):d.default.warning("请选择课程")})),(0,S.default)((0,h.default)(e),"search",(function(){e.props.selectEnterpriseCourse({csiteId:e.props.siteId})})),(0,S.default)((0,h.default)(e),"onAddCourseModal",(function(){e.props.siteId?e.setState({visible:!0}):d.default.error("请选择站点")})),e}return(0,m.default)(r,[{key:"componentDidMount",value:function(){this.props.getSortList({pageNo:1,pageSize:1e4})}},{key:"render",value:function(){var e=this,t=this.props,a=(t.sortlist,t.selectCourseData,this.props.form.getFieldDecorator,this.props.selectEnterpriseCourseData),r=this.state.selectCourses,n=[].concat((0,f.default)(r),(0,f.default)(a)),d=[{title:"课程编码",dataIndex:"courseCode",width:"35%",key:"courseCode",render:function(e,t){return t.code||t.courseCode}},{title:"课程名称",dataIndex:"courseName",width:"35%",key:"courseName",render:function(e,t){return t.name||t.courseName}},{title:"到期时间",dataIndex:"expireDate",key:"expireDate",render:function(t,a){return C.default.createElement("span",{onClick:function(){return e.onTimeModal(a)}},C.default.createElement("span",{style:{width:145,display:"inline-block"}},t?(0,E.default)(t).format("YYYY-MM-DD"):"长期有效"),C.default.createElement(c.default,{type:"edit",style:{color:"#1890ff"}}))}}],p={onChange:function(t,a){console.log("selectedRowKeys: ".concat(t),"selectedRows: ",a),e.setState({selectedRows:a,selectedRowKeys:t})}};return C.default.createElement("div",{style:{width:"900px"}},C.default.createElement(o.default,null,C.default.createElement(i.default,{type:"flex",style:{width:"100%"}},C.default.createElement("span",{style:{marginLeft:17,lineHeight:"33px"}},"添加课程:"),C.default.createElement(u.default,{type:"primary",onClick:this.onAddCourseModal,style:{marginLeft:10}},"添加课程")),C.default.createElement("div",null,C.default.createElement(s.default,{columns:d,dataSource:n,rowSelection:p,rowKey:"id"}))),C.default.createElement(l.default,{key:this.state.key,title:this.state.title,visible:this.state.visible,onOk:this.hideModal,destroyOnClose:1,maskClosable:0,onCancel:function(){return e.setState({visible:!1})},footer:!1,width:800},C.default.createElement(D.default,{onCancel:function(){return e.setState({visible:!1})},siteId:this.props.siteId,siteName:this.props.siteName,search:this.search})),this.state.timeModal&&C.default.createElement(l.default,{title:"设置有效期",visible:this.state.timeModal,onOk:this.onSetTime,destroyOnClose:1,maskClosable:0,onCancel:function(){return e.setState({timeModal:!1})}},C.default.createElement(b.default,{data:this.state.editVo,onSetTime:this.onSetTime,ref:function(t){return e.timeModalRef=t}})))}}]),r}(C.Component),I=o.default.create()(w);t.default=I},1770:function(e,t,a){"use strict";var r=a(4),n=a(0);a(51),a(20),a(34),a(35),a(23),a(229),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a(549);var l=n(a(544));a(140);var o=n(a(535));a(537);var s=n(a(536));a(764);var i=n(a(765));a(61);var u=n(a(62)),c=n(a(29)),d=n(a(30)),f=n(a(59)),p=n(a(32)),m=n(a(33)),h=n(a(31)),y=n(a(2)),v=r(a(1)),g=a(52),S=r(a(1318));function C(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function D(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?C(Object(a),!0).forEach((function(t){(0,y.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):C(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function b(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var E=function(e){(0,p.default)(r,e);var t,a=(t=r,function(){var e,a=(0,h.default)(t);if(b()){var r=(0,h.default)(this).constructor;e=Reflect.construct(a,arguments,r)}else e=a.apply(this,arguments);return(0,m.default)(this,e)});function r(e){var t;return(0,c.default)(this,r),t=a.call(this,e),(0,y.default)((0,f.default)(t),"search",(function(){var e={authorizeSiteId:t.props.siteId,pageNo:1,pageSize:1e3,shelves:1,name:t.state.name,classifyId:t.state.classifyId};e.name||delete e.name,e.classifyId||delete e.classifyId,t.props.getAuthorizelist(e)})),(0,y.default)((0,f.default)(t),"add",(function(e){var a=t.state,r=a.selectedRowKeys,n=a.selectedRows;if(0!==r.length){var l=t.props,o={authorizationCourseVOs:n,accreditVO:{siteId:l.siteId,siteName:l.siteName,useDuration:null,useType:0,saleAuthorizeStatus:0,type:1}};t.setState({loading:!0}),t.props.authorize(o,(function(){t.setState({loading:!1}),t.props.onCancel(),t.props.search()}))}else u.default.error("请选择课程")})),(0,y.default)((0,f.default)(t),"handleSearchSelect",(function(e){var a={classifyId:e,authorizeSiteId:t.props.siteId,pageNo:1,pageSize:1e3,shelves:1,name:t.state.name};a.name||delete a.name,a.classifyId||delete a.classifyId,t.props.getAuthorizelist(a),t.setState({classifyId:e})})),t.state={name:"",selectedRowKeys:[],selectedRows:[],classifyId:null,loading:!1},t}return(0,d.default)(r,[{key:"componentDidMount",value:function(){this.props.getAuthorizelist({authorizeSiteId:this.props.siteId,pageNo:1,shelves:1,pageSize:1e3}),this.props.getSortList({pageNo:1,pageSize:1e4})}},{key:"render",value:function(){var e=this,t=[{title:"名称",key:"name",dataIndex:"name",render:function(e){return v.default.createElement("span",{title:e},e.length>10?e.substring(9,0)+"...":e)}}],a=this.props.courseSale.selectCourseList.records,r=void 0===a?[]:a,n=this.props.courseSale.list,u={hideDefaultSelections:!0,onChange:function(t,a){e.setState({selectedRowKeys:t,selectedRows:a})},getCheckboxProps:function(e){return{disabled:e.disabled}}};return v.default.createElement("div",null,v.default.createElement("div",null,v.default.createElement("span",{style:{marginRight:"10px"}},"课程分类:"),v.default.createElement(i.default,{treeData:n,placeholder:"请选择课程分类",onSelect:this.handleSearchSelect,style:{width:"200px"}}),v.default.createElement("span",{style:{marginLeft:"10px"}},"课程关键字："),v.default.createElement(s.default,{placeholder:"请输入课程名称或课程编码",style:{width:"200px",marginRight:"10px"},value:this.state.name,ref:function(t){return e.in=t},onChange:function(){return e.setState({name:e.in.input.value})}}),v.default.createElement(o.default,{type:"primary",style:{marginRight:"15px"},onClick:this.search},"搜索"),v.default.createElement(o.default,{type:"primary",onClick:this.add,style:{marginLeft:"10"},loading:this.state.loading},"添加")),v.default.createElement(l.default,{columns:t,dataSource:r,rowSelection:u,rowKey:"courseId"}))}}]),r}(v.Component),O=(0,g.connect)((function(e){return D({},e)}),D({},S.default))(E);t.default=O},1771:function(e,t,a){e.exports={auth:"auth__2yrtZ","ant-col-3":"ant-col-3__2KuLP","ant-col-5":"ant-col-5__Oam74","ant-form-item-control":"ant-form-item-control__ckYYg"}},1772:function(e,t,a){"use strict";var r=a(4),n=a(0);a(3),a(159),a(82),a(43),a(20),a(34),a(35),a(23),a(84),a(229),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a(224);var l=n(a(225)),o=n(a(98));a(99);var s=n(a(100));a(140);var i=n(a(535));a(537);var u=n(a(536));a(61);var c=n(a(62)),d=n(a(29)),f=n(a(30)),p=n(a(59)),m=n(a(32)),h=n(a(33)),y=n(a(31)),v=n(a(2));a(592);var g=n(a(566));a(554);var S=n(a(550)),C=r(a(1)),D=n(a(1458)),b=n(a(1773)),E=n(a(1535)),O=n(a(223)),w=a(52),I=r(a(1318));function R(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function k(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?R(Object(a),!0).forEach((function(t){(0,v.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):R(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function N(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var M=S.default.Option,z=g.default.RangePicker,P=function(e){(0,m.default)(r,e);var t,a=(t=r,function(){var e,a=(0,y.default)(t);if(N()){var r=(0,y.default)(this).constructor;e=Reflect.construct(a,arguments,r)}else e=a.apply(this,arguments);return(0,h.default)(this,e)});function r(e){var t;return(0,d.default)(this,r),t=a.call(this,e),(0,v.default)((0,p.default)(t),"onChangePage",(function(e){var a=t.state,r=a.courseKeys,n=a.startTime,l=a.endTime,o=a.activeType,s={courseKeys:r,startTime:n,endTime:l,pageNo:e,pageSize:t.props.courseSale.courseSaleLookData.pageSize,activeType:o,type:1};s.siteId=t.props.siteId,t.props.authorizeLook(s)})),(0,v.default)((0,p.default)(t),"onChangePageSize",(function(e,a){var r=t.state,n={courseKeys:r.courseKeys,startTime:r.startTime,endTime:r.endTime,page:e,pageSize:a,activeType:r.activeType,type:1};n.siteId=t.props.siteId,t.props.authorizeLook(n)})),(0,v.default)((0,p.default)(t),"onBatchSetTime",(function(){var e=t.state;e.selectCourses;0!==e.selectedRowKeys.length?t.setState({timeModal:!0,editVo:void 0}):c.default.warning("请选择课程")})),(0,v.default)((0,p.default)(t),"header",(function(){return C.default.createElement("div",null,C.default.createElement(u.default,(0,v.default)({placeholder:"请输入课程名称或课程编码",addonBefore:"课程关键字",onChange:t.handleGetValue,style:{width:300,marginRight:10},ref:function(e){return t.courseKeys=e}},"onChange",(function(e){return t.setState({courseKeys:t.courseKeys.input.value})}))),C.default.createElement("span",null,"分配时间"),C.default.createElement(z,{style:{margin:"0 10px"},onChange:t.handleTime}),C.default.createElement("span",null,"授权状态"),C.default.createElement(S.default,{defaultValue:"2",style:{width:120,marginLeft:10,marginRight:10},onChange:function(e){return t.setState({activeType:e})}},C.default.createElement(M,{value:"2"},"请选择"),C.default.createElement(M,{value:"0"},"活跃"),C.default.createElement(M,{value:"1"},"已到期")),C.default.createElement(i.default,{type:"primary",onClick:t.search},"查询"),C.default.createElement("div",{style:{marginTop:10}},C.default.createElement(i.default,{type:"primary",onClick:function(){return t.setState({addVisible:!0})},style:{marginLeft:10}},"添加课程")))})),(0,v.default)((0,p.default)(t),"search",(function(){var e=t.state,a={courseKeys:e.courseKeys,startTime:e.startTime,endTime:e.endTime,activeType:e.activeType,type:1};a.siteId=t.props.siteId,t.props.authorizeLook(a)})),(0,v.default)((0,p.default)(t),"handleTime",(function(e){e.length>0?t.setState({startTime:(0,O.default)(e[0]).format("YYYY-MM-DD"),endTime:(0,O.default)(e[1]).format("YYYY-MM-DD")}):t.setState({startTime:"",endTime:""})})),(0,v.default)((0,p.default)(t),"onSetTime",(function(){console.log("设置时间"),t.timeModalRef.validateFields((function(e,a){if(!e){console.log("Received values of form: ",a);var r=t.state,n=(r.companyId,r.companyName,r.siteId,r.siteName,r.editVo),l=(r.selectCourses,r.selectedRowKeys);t.setState({timeModal:!1});var o=t.props.courseSale.courseSaleLookData.records,s=void 0===o?[]:o;if(n){var i=s.find((function(e){return e.id==n.id}));"0"===a.useType?i.expireDate=null:i.expireDate=(0,O.default)(a.useDuration).format("YYYY-MM-DD HH:mm:ss");var u={ids:[n.id],validDate:"0"===a.useType?null:(0,O.default)(a.useDuration).valueOf()};t.props.updateValidDate2(u,(function(){console.log("设置时间的回调")}))}else{var c={ids:s.filter((function(e){return l.includes(e.id)})).map((function(e){return e.id})),validDate:"0"===a.useType?null:(0,O.default)(a.useDuration).valueOf()};t.props.updateValidDate2(c,(function(){}))}}}))})),t.state={courseKeys:"",activeType:2,selectedRowKeys:[]},t}return(0,f.default)(r,[{key:"componentDidMount",value:function(){this.search()}},{key:"render",value:function(){var e=this,t=[{title:"课程编码",key:"courseCode",dataIndex:"courseCode"},{title:"课程名称",key:"courseName",dataIndex:"courseName",render:function(e){return C.default.createElement("span",{title:e},e.length>10?e.substring(9,0)+"...":e)}},{title:"授权状态",key:"授权状态",dataIndex:"授权状态",render:function(e,t){return 0===t.useType||(0,O.default)((0,O.default)(t.expireDate).format("YYYY-MM-DD")).diff((0,O.default)((0,O.default)().format("YYYY-MM-DD")),"days")+1>0?"活跃":"已到期"}},{title:"分配时间",key:"authorizeTime",dataIndex:"authorizeTime",render:function(e,t){return(0,O.default)(t.authorizeTime).format("YYYY-MM-DD")}},{title:"剩余有效天数",key:"validDays",dataIndex:"validDays",render:function(e,t){if(0===t.useType)return"长期有效";var a=(0,O.default)((0,O.default)(t.expireDate).format("YYYY-MM-DD")).diff((0,O.default)((0,O.default)().format("YYYY-MM-DD")),"days")+1;return a>0?a:0}},{title:"到期时间",dataIndex:"expireDate",key:"expireDate",render:function(t,a){return C.default.createElement("span",{onClick:function(){return e.setState({timeModal:!0,editVo:a})}},C.default.createElement("span",{style:{width:145,display:"inline-block"}},t?(0,O.default)(t).format("YYYY-MM-DD"):"长期有效"),C.default.createElement(s.default,{type:"edit",style:{color:"#1890ff"}}))}}],a={onChange:function(t,a){e.setState({selectedRows:a,selectedRowKeys:t})}},r=this.props.courseSale.courseSaleLookData,n=r.records,i=void 0===n?[]:n,u=r.pageNo,c=void 0===u?1:u,d=r.pageSize,f=void 0===d?20:d,p=r.pageRecords,m=void 0===p?0:p;return console.log(m,"---------pageRecords-------"),C.default.createElement("div",null,C.default.createElement(D.default,{rowKey:"id",columns:t,dataSource:i,header:this.header,current:c,rowSelection:a,pageSize:f,total:m,onChangePage:this.onChangePage,onChangePageSize:this.onChangePageSize,rangeFlag:!0}),this.state.addVisible&&C.default.createElement(l.default,{title:"添加课程",visible:this.state.addVisible,onOk:this.hideModal,destroyOnClose:1,maskClosable:0,onCancel:function(){return e.setState({addVisible:!1})},footer:!1,width:800},C.default.createElement(b.default,(0,o.default)({onCancel:function(){return e.setState({addVisible:!1})},onSelectCourse:this.onSelectCourse},this.props,{search:this.search}))),this.state.timeModal&&C.default.createElement(l.default,{title:"设置有效期",visible:this.state.timeModal,onOk:this.onSetTime,destroyOnClose:1,maskClosable:0,onCancel:function(){return e.setState({timeModal:!1})}},C.default.createElement(E.default,{data:this.state.editVo,onSetTime:this.onSetTime,ref:function(t){return e.timeModalRef=t}})))}}]),r}(C.Component),x=(0,w.connect)((function(e){return k({},e)}),k({},I.default))(P);t.default=x},1773:function(e,t,a){"use strict";var r=a(4),n=a(0);a(51),a(20),a(34),a(35),a(23),a(229),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a(549);var l=n(a(544));a(140);var o=n(a(535));a(537);var s=n(a(536));a(764);var i=n(a(765));a(61);var u=n(a(62)),c=n(a(29)),d=n(a(30)),f=n(a(59)),p=n(a(32)),m=n(a(33)),h=n(a(31)),y=n(a(2)),v=r(a(1)),g=a(52),S=r(a(1318));function C(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function D(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?C(Object(a),!0).forEach((function(t){(0,y.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):C(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function b(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var E=function(e){(0,p.default)(r,e);var t,a=(t=r,function(){var e,a=(0,h.default)(t);if(b()){var r=(0,h.default)(this).constructor;e=Reflect.construct(a,arguments,r)}else e=a.apply(this,arguments);return(0,m.default)(this,e)});function r(e){var t;return(0,c.default)(this,r),t=a.call(this,e),(0,y.default)((0,f.default)(t),"search",(function(){var e={authorizeSiteId:t.props.siteId,pageNo:1,pageSize:1e3,shelves:1,name:t.state.name,classifyId:t.state.classifyId};e.name||delete e.name,e.classifyId||delete e.classifyId,t.props.getAuthorizelist(e)})),(0,y.default)((0,f.default)(t),"add",(function(e){var a=t.state,r=a.selectedRowKeys,n=a.selectedRows;if(console.log("=========选择的课程==========================="),console.log(n),console.log("===================================="),0!==r.length){var l=t.props,o={authorizationCourseVOs:n,accreditVO:{companyId:l.companyId,companyName:l.companyName,siteId:l.siteId,siteName:l.siteName,useDuration:null,useType:0,saleAuthorizeStatus:0,type:1}};t.setState({loading:!0}),t.props.authorize(o,(function(){t.setState({loading:!1}),t.props.onCancel(),t.props.search()}))}else u.default.error("请选择课程")})),(0,y.default)((0,f.default)(t),"handleSearchSelect",(function(e){var a={classifyId:e,authorizeSiteId:t.props.siteId,pageNo:1,pageSize:1e3,shelves:1,name:t.state.name};a.name||delete a.name,a.classifyId||delete a.classifyId,t.props.getAuthorizelist(a),t.setState({classifyId:e})})),t.state={name:"",selectedRowKeys:[],selectedRows:[],classifyId:null,loading:!1},t}return(0,d.default)(r,[{key:"componentDidMount",value:function(){this.props.getAuthorizelist({authorizeSiteId:this.props.siteId,pageNo:1,shelves:1,pageSize:1e3}),this.props.getSortList({pageNo:1,pageSize:1e4})}},{key:"render",value:function(){var e=this,t=[{title:"名称",key:"name",dataIndex:"name",render:function(e){return v.default.createElement("span",{title:e},e.length>10?e.substring(9,0)+"...":e)}}],a=this.props.courseSale.selectCourseList.records,r=void 0===a?[]:a,n=this.props.courseSale.list,u={hideDefaultSelections:!0,onChange:function(t,a){e.setState({selectedRowKeys:t,selectedRows:a})},getCheckboxProps:function(e){return{disabled:e.disabled}}};return v.default.createElement("div",null,v.default.createElement("div",null,v.default.createElement("span",{style:{marginRight:"10px"}},"课程分类:"),v.default.createElement(i.default,{treeData:n,placeholder:"请选择课程分类",onSelect:this.handleSearchSelect,style:{width:"200px"}}),v.default.createElement("span",{style:{marginLeft:"10px"}},"课程关键字："),v.default.createElement(s.default,{placeholder:"请输入课程名称或课程编码",style:{width:"200px",marginRight:"10px"},value:this.state.name,ref:function(t){return e.in=t},onChange:function(){return e.setState({name:e.in.input.value})}}),v.default.createElement(o.default,{type:"primary",style:{marginRight:"15px"},onClick:this.search},"搜索"),v.default.createElement(o.default,{type:"primary",onClick:this.add,loading:this.state.loading},"添加")),v.default.createElement(l.default,{columns:t,dataSource:r,rowSelection:u,rowKey:"courseId"}))}}]),r}(v.Component),O=(0,g.connect)((function(e){return D({},e)}),D({},S.default))(E);t.default=O}}]);