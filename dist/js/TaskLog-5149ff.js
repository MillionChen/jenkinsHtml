(window.webpackJsonp=window.webpackJsonp||[]).push([[122],{1531:function(t,e,a){"use strict";var n=a(0),r=a(4);Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o=r(a(1718)),l=n(a(76)),u=n(a(1719)).default.system,i=u.taskLog,c=u.taskLogDetailList,s={taskLog:function(t,e){return function(a){return(0,l.default)({url:i,data:t}).then((function(t){1e3==t.code?e&&e(t):1e3!==t.code&&e&&e(t.code,t.msg),a({type:o.TASK_LOG,taskLog:t.data})})).catch((function(t){console.log(t)}))}},taskLogDetailList:function(t,e){return function(a){return(0,l.default)({url:c,data:t}).then((function(t){e&&e(t),1e3==t.code||1e3!==t.code&&e&&e(t.code,t.msg),a({type:o.TASK_LOG_DETAIL_LIST,taskLookData:t.data})})).catch((function(t){}))}}};e.default=s},1717:function(t,e,a){"use strict";var n=a(4),r=a(0);a(51),a(20),a(34),a(35),a(23),a(229),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,a(224);var o=r(a(225));a(569);var l=r(a(558));a(549);var u=r(a(544));a(537);var i=r(a(536));a(590);var c=r(a(591)),s=r(a(29)),d=r(a(30)),f=r(a(59)),p=r(a(32)),g=r(a(33)),h=r(a(31)),m=r(a(2)),v=n(a(1)),y=a(52),L=n(a(1531)),O=r(a(223)),k=r(a(1720)),S=r(a(226));function b(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,n)}return a}function D(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?b(Object(a),!0).forEach((function(e){(0,m.default)(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):b(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}function E(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}var w=function(t){(0,p.default)(n,t);var e,a=(e=n,function(){var t,a=(0,h.default)(e);if(E()){var n=(0,h.default)(this).constructor;t=Reflect.construct(a,arguments,n)}else t=a.apply(this,arguments);return(0,g.default)(this,t)});function n(t){var e;return(0,s.default)(this,n),e=a.call(this,t),(0,m.default)((0,f.default)(e),"search",(function(t){t.pageNo;e.setState({pageNo:1});var a={pageNo:1,pageSize:10},n=e.state,r=n.serialNo,o=n.name;""!==r&&(a.serialNo=r),""!==o&&(a.name=o),e.props.taskLog(a,(function(t){var a=t.data.records,n=t.data;e.setState({records:a,data:n})}))})),(0,m.default)((0,f.default)(e),"showModal",(function(t){e.setState({visible:!0,type:"edit",title:t})})),(0,m.default)((0,f.default)(e),"hideModal",(function(){e.setState({visible:!1})})),(0,m.default)((0,f.default)(e),"editModal",(function(t,a){e.setState({bl:!0}),e.props.taskLogDetailList({pageNo:"1",pageSize:"10",logId:a.id},(function(t){e.setState({taskLogData:t.data,taskLogId:a.id}),e.showModal()}))})),(0,m.default)((0,f.default)(e),"pageOnChange",(function(t){var a={pageNo:t,pageSize:10},n=e.state,r=n.serialNo,o=n.name;""!==r&&(a.serialNo=r),""!==o&&(a.name=o),(0,e.props.taskLog)(a,(function(t){var a=t.data.records,n=t.data;e.setState({records:a,data:n})}))})),(0,m.default)((0,f.default)(e),"onShowSizeChange",(function(t,a){var n={pageNo:1,pageSize:a};(0,e.props.taskLog)(n,(function(t){var a=t.data.records,n=t.data;e.setState({records:a,data:n})}))})),(0,m.default)((0,f.default)(e),"showTotal",(function(t){return"共计 ".concat(t," 条")})),e.state={searchName:"",data:{},records:[],taskLogData:[],title:"",total:null,current:1,updateFlag:!1,taskLogId:""},e}return(0,d.default)(n,[{key:"componentDidMount",value:function(){var t=this;(0,this.props.taskLog)({pageNo:1,pageSize:10},(function(e){var a=e.data.records,n=e.data;t.setState({records:a,data:n})}))}},{key:"changeData",value:function(t){this.setState({taskLogData:t})}},{key:"render",value:function(){var t=this;console.log("检测打印变量=this.props ",this.props);var e=this.state,a=e.records,n=(e.taskLogData,e.data),r=(e.bl,e.pageNo,[{title:"任务序号",dataIndex:"serialNo",render:function(t){return v.default.createElement("span",{title:t},t.length>10?"".concat(t.substring(9,0),"..."):t)}},{title:"任务名称",dataIndex:"name",render:function(t){return v.default.createElement("span",{title:t},t.length>10?"".concat(t.substring(9,0),"..."):t)}},{title:"创建时间",dataIndex:"submitTime",render:function(t){return v.default.createElement("span",null,(0,O.default)(t).format("YYYY-MM-DD HH:mm:ss"))}},{title:"执行状态",dataIndex:"status",render:function(t){return 1==t?v.default.createElement("span",null,"进行中"):2==+t?v.default.createElement("span",null,"已完成"):v.default.createElement("span",null,"执行失败")}},{title:"执行结果",dataIndex:"result",render:function(t){return v.default.createElement("span",{title:t},t.length>10?"".concat(t.substring(9,0),"..."):t)}},{title:"操作",key:"options",render:function(e,a,n){if(""!=a.url&&2==a.status)return v.default.createElement("span",null,v.default.createElement("a",{"data-index":n,href:a.url},"下载结果"),v.default.createElement(c.default,{type:"vertical"}),v.default.createElement("a",{"data-index":n,onClick:function(){return t.editModal("查看错误日志",a)}},"查看"))}}]);return v.default.createElement("div",{style:{background:"#fff",padding:"40px 20px"}},v.default.createElement(S.default,{title:"任务管理"}),v.default.createElement("div",{style:{overflow:"hidden",padding:" 20px 0"}},v.default.createElement("div",null,v.default.createElement("div",{style:{float:"left"}},v.default.createElement("span",null,"任务管理")),v.default.createElement("div",{style:{float:"right"}},v.default.createElement(i.default.Search,{placeholder:"请输入任务序号,任务名称",style:{width:250,marginRight:10},onChange:function(e){var a=e.target.value;t.setState({name:a})},onSearch:this.search,onMouseEnter:this.search})))),v.default.createElement(u.default,{columns:r,dataSource:a,pagination:!1,rowKey:function(t){return t.id}}),v.default.createElement(l.default,{style:{textAlign:"right",marginRight:"15px",marginTop:"15px"},showTotal:this.showTotal,onChange:this.pageOnChange,current:n.pageNo,total:n.pageRecords,showSizeChanger:!0,showQuickJumper:!0,onShowSizeChange:this.onShowSizeChange}),v.default.createElement(o.default,{title:this.state.title,visible:this.state.visible,onOk:this.hideModal,onCancel:this.hideModal,width:800,key:this.state.taskLogId},v.default.createElement(k.default,{taskLogData:this.state.taskLogData,changeData:this.changeData,taskLogId:this.state.taskLogId})))}}]),n}(v.Component),T=(0,y.connect)((function(t){return D({},t)}),D({},L.default))(w);e.default=T},1718:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.TASK_LOG_DETAIL_LIST=e.TASK_LOG=void 0;e.TASK_LOG="TASK_LOG";e.TASK_LOG_DETAIL_LIST="TASK_LOG_DETAIL_LIST"},1719:function(t,e,a){"use strict";var n=a(0);Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=n(a(63)),o={system:{taskLog:"POST ".concat(r.default.base,"/log/manage/tasklog/list"),taskLogDetailList:"POST ".concat(r.default.base,"/log/manage/tasklog/detail/list")}};e.default=o},1720:function(t,e,a){"use strict";var n=a(4),r=a(0);a(20),a(34),a(23),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,a(569);var o=r(a(558));a(549);var l=r(a(544)),u=r(a(29)),i=r(a(30)),c=r(a(59)),s=r(a(32)),d=r(a(33)),f=r(a(31)),p=r(a(2)),g=n(a(1)),h=r(a(223)),m=a(52),v=n(a(1531));function y(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,n)}return a}function L(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?y(Object(a),!0).forEach((function(e){(0,p.default)(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):y(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}function O(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}var k=function(t){(0,s.default)(n,t);var e,a=(e=n,function(){var t,a=(0,f.default)(e);if(O()){var n=(0,f.default)(this).constructor;t=Reflect.construct(a,arguments,n)}else t=a.apply(this,arguments);return(0,d.default)(this,t)});function n(t){var e;(0,u.default)(this,n),e=a.call(this,t),(0,p.default)((0,c.default)(e),"showTotals",(function(t){return"共计 ".concat(t," 条")}));var r=e.props.taskLogId,o=e.props.taskLogData;return e.state={taskLogData:o,taskLogId:r,current:1,pageSize:10,total:null},e.pageChange=e.pageChange.bind((0,c.default)(e)),e}return(0,i.default)(n,[{key:"pageChange",value:function(t){var e=this,a=this.state,n=a.taskLogId,r=a.pageSize;console.log("Page: ",t);this.props.taskLogDetailList({pageNo:t,pageSize:r,logId:n},(function(t){e.setState({taskLogData:t.data}),e.props.changeData(t.data)}))}},{key:"render",value:function(){var t=this.state,e=t.taskLogData,a=(t.current,t.total,[{title:"错误信息",dataIndex:"content",render:function(t){return g.default.createElement("span",{title:t},t.length>10?"".concat(t.substring(9,0),"..."):t)}},{title:"创建时间",dataIndex:"createTime",render:function(t,e,a){return g.default.createElement("span",{key:a},(0,h.default)(e.createTime).format("YYYY-MM-DD HH:mm:ss"))}}]);return g.default.createElement("div",null,g.default.createElement(l.default,{style:{marginLeft:20,marginRight:20,marginTop:10},columns:a,dataSource:e.records,pagination:!1,rowKey:function(t){return t.id}}),g.default.createElement(o.default,{style:{textAlign:"right",marginRight:"15px",marginTop:"15px"},showTotal:this.showTotals,onChange:this.pageChange,current:e.pageNo,total:e.pageRecords}))}}]),n}(g.Component),S=(0,m.connect)((function(t){return L({},t)}),L({},v.default))(k);e.default=S},536:function(t,e,a){t.exports=a(11)(166)},537:function(t,e,a){"use strict";a.r(e);a(26),a(586),a(140)},544:function(t,e,a){t.exports=a(11)(846)},558:function(t,e,a){t.exports=a(11)(251)},586:function(t,e,a){},590:function(t,e,a){"use strict";a.r(e);a(26),a(597)},591:function(t,e,a){t.exports=a(11)(819)},597:function(t,e,a){}}]);