(window.webpackJsonp=window.webpackJsonp||[]).push([[128],{1329:function(e,t,a){"use strict";var n=a(4),r=a(0);a(20),a(34),a(23),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a(569);var l=r(a(558));a(549);var o=r(a(544)),u=r(a(98)),i=r(a(237)),c=r(a(29)),d=r(a(30)),f=r(a(32)),s=r(a(33)),p=r(a(31)),m=n(a(1));function g(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var h=a(1361),y=function(e){(0,f.default)(n,e);var t,a=(t=n,function(){var e,a=(0,p.default)(t);if(g()){var n=(0,p.default)(this).constructor;e=Reflect.construct(a,arguments,n)}else e=a.apply(this,arguments);return(0,s.default)(this,e)});function n(e){var t;return(0,c.default)(this,n),(t=a.call(this,e)).state={columns:[]},t}return(0,d.default)(n,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){var e=this.props,t=e.columns,a=void 0===t?[]:t,n=e.tableData,r=void 0===n?[]:n,c=e.dataTotal,d=void 0===c?0:c,f=e.showPagination,s=void 0===f||f,p=(e.paginationFloat,e.paginationStyle),g=void 0===p?{}:p,y=(0,i.default)(e,["columns","tableData","dataTotal","showPagination","paginationFloat","paginationStyle"]);return m.default.createElement("div",{style:{width:this.props.width||"100%"}},m.default.createElement(o.default,(0,u.default)({},y,{rowKey:this.props.rowKey?this.props.rowKey:"id",columns:a,dataSource:r,onChange:function(){},pagination:!1})),s&&m.default.createElement("div",{style:{textAlign:"center"}}," ",m.default.createElement(l.default,(0,u.default)({className:h.paginations},g,{total:d,showTotal:function(e){return"共有".concat(e,"条")},showSizeChanger:!0,showQuickJumper:!0,defaultPageSize:10,defaultCurrent:1,pageSizeOptions:["10","20","50","100"],onChange:this.props.changePageNo||null,onShowSizeChange:this.props.onShowSizeChange||null})),m.default.createElement("p",{style:{clear:"both"}})))}}]),n}(m.Component);t.default=y},1337:function(e,t,a){"use strict";var n=a(0);Object.defineProperty(t,"__esModule",{value:!0}),t.recommendStrategyCopy=function(e,t){return function(a){return(0,r.default)({url:o,data:e}).then((function(e){t&&t(e)}))}},t.recommendStrategyDelete=function(e,t){return function(a){return(0,r.default)({url:u,data:e}).then((function(e){t&&t(e)}))}},t.recommendStrategyPage=function(e,t){return function(a){return(0,r.default)({url:i,data:e}).then((function(e){t&&t(e)}))}},t.recommendRulePage=function(e,t){return function(a){return(0,r.default)({url:c,data:e}).then((function(e){t&&t(e)}))}},t.recommendRuleIdsGet=function(e,t){return function(a){return(0,r.default)({url:d,data:e}).then((function(e){t&&t(e)}))}},t.recommendStrategyView=function(e,t){return function(a){return(0,r.default)({url:f,data:e}).then((function(e){t&&t(e)}))}},t.recommendStrategySave=function(e,t){return function(a){return(0,r.default)({url:s,data:e}).then((function(e){t&&t(e)}))}},t.rulesGetInitJson=function(e){return function(t){return(0,r.default)({url:p}).then((function(t){e&&e(t)}))}},t.recommendStrategyDrools=function(e,t){return function(a){return(0,r.default)({url:m,data:e}).then((function(e){t&&t(e)}))}},t.recommendRuleTemplateSave=function(e,t){return function(a){return(0,r.default)({url:g,data:e}).then((function(e){t&&t(e)}))}};var r=n(a(76)),l=n(a(1414)),o=l.default.recommendStrategyCopyApi,u=l.default.recommendStrategyDeleteApi,i=l.default.recommendStrategyPageApi,c=l.default.recommendRulePageApi,d=l.default.recommendRuleIdsGetApi,f=l.default.recommendStrategyViewApi,s=l.default.recommendStrategySaveApi,p=l.default.rulesGetInitJsonApi,m=l.default.recommendStrategyDroolsApi,g=l.default.recommendRuleTemplateSaveApi},1361:function(e,t,a){e.exports={paginations:"paginations__f66HM",colors:"colors__1nXFg"}},1386:function(e,t,a){"use strict";var n=a(0);Object.defineProperty(t,"__esModule",{value:!0}),t.recommendRulePage=function(e,t){return function(a){return(0,r.default)({url:o,data:e}).then((function(e){t&&t(e)}))}},t.recommendRuleCopy=function(e,t){return function(a){return(0,r.default)({url:u,data:e}).then((function(e){t&&t(e)}))}},t.recommendRuleDelete=function(e,t){return function(a){return(0,r.default)({url:i,data:e}).then((function(e){t&&t(e)}))}},t.getVisibleRangeToContent=function(e,t){return function(a){return(0,r.default)({url:c,data:e}).then((function(e){t&&t(e)}))}},t.recommendRuleGetVisibleRangeToUser=function(e,t){return function(a){return(0,r.default)({url:d,data:e}).then((function(e){t&&t(e)}))}},t.recommendRuleStrategyPage=function(e,t){return function(a){return(0,r.default)({url:f,data:e}).then((function(e){t&&t(e)}))}},t.recommendRuleIdsGet=function(e,t){return function(a){return(0,r.default)({url:s,data:e}).then((function(e){t&&t(e)}))}},t.recommendRuleTemplateSave=function(e,t){return function(a){return(0,r.default)({url:p,data:e}).then((function(e){t&&t(e)}))}};var r=n(a(76)),l=n(a(1476)),o=l.default.recommendRulePageApi,u=l.default.recommendRuleCopyApi,i=l.default.recommendRuleDeleteApi,c=l.default.getVisibleRangeToContentApi,d=l.default.recommendRuleGetVisibleRangeToUserApi,f=l.default.recommendRuleStrategyPageApi,s=l.default.recommendRuleIdsGetApi,p=l.default.recommendRuleTemplateSaveApi},1414:function(e,t,a){"use strict";var n=a(0);a(44),Object.defineProperty(t,"__esModule",{value:!0}),t.recommendRuleTemplateSave=function(e){return post("/rules/manage/recommendRule/template/save?companyCode=".concat(companyCode,"&siteCode=").concat(siteCode),e)},t.default=void 0;var r=n(a(63)),l={recommendStrategyCopyApi:"POST ".concat(r.default.base,"/rules/manage/recommendStrategy/copy"),recommendStrategyDeleteApi:"POST ".concat(r.default.base,"/rules/manage/recommendStrategy/delete"),recommendStrategyPageApi:"GET ".concat(r.default.base,"/rules/manage/recommendStrategy/page"),recommendRulePageApi:"GET ".concat(r.default.base,"/rules/manage/recommendRule/page"),recommendRuleIdsGetApi:"POST ".concat(r.default.base,"/rules/manage/recommendRule/ids/get"),recommendStrategyViewApi:"GET ".concat(r.default.base,"/rules/manage/recommendStrategy/view"),recommendStrategySaveApi:"POST ".concat(r.default.base,"/rules/manage/recommendStrategy/save"),rulesGetInitJsonApi:"GET ".concat(r.default.base,"/rules/manage/recommendRule/getJson"),recommendStrategyDroolsApi:"POST ".concat(r.default.base,"/web-manage/drools/manage/task/page"),recommendRuleTemplateSaveApi:"POST ".concat(r.default.base,"/rules/manage/recommendRule/template/save")};t.default=l},1475:function(e,t,a){"use strict";var n=a(4),r=a(0);a(7),a(44),a(3),a(5),a(43),a(107),a(51),a(9),a(10),a(8),a(20),a(34),a(23),a(6),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a(99);var l=r(a(100));a(537);var o=r(a(536));a(61);var u=r(a(62)),i=r(a(79)),c=r(a(238));a(239);var d=r(a(240)),f=r(a(29)),s=r(a(30)),p=r(a(59)),m=r(a(32)),g=r(a(33)),h=r(a(31)),y=r(a(2));a(554);var v=r(a(550));a(540);var S=r(a(539)),b=n(a(1)),D=a(52),O=n(a(1337));function w(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function k(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?w(Object(a),!0).forEach((function(t){(0,y.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):w(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function R(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var E=S.default.Item,P=v.default.Option,C=0,x=function(e){(0,m.default)(n,e);var t,a=(t=n,function(){var e,a=(0,h.default)(t);if(R()){var n=(0,h.default)(this).constructor;e=Reflect.construct(a,arguments,n)}else e=a.apply(this,arguments);return(0,g.default)(this,e)});function n(e){var t;return(0,f.default)(this,n),t=a.call(this,e),(0,y.default)((0,p.default)(t),"queryData",(0,d.default)(c.default.mark((function e(){return c.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.props.rulesGetInitJson((function(e){if(1e3==e.code&&e.data){var a=t.state,n=a.defaultArray,r=a.userList,l=Object.keys(e.data.property.user),o=Object.keys(e.data.relation);n={property:l[0],relation:o[0]},r=e.data.property.user;var u=t.props.cacheList,i=void 0===u?[]:u,c=t.state.optionData;if(i.length){for(var d=[],f=t.props.form,s=f.getFieldValue("keys"),p=0;p<i.length;p++)d.push(i[p]),c.push({pageNo:1,list:[]}),0!=p&&s.push(C++);t.setState({relationList:e.data.relation,formSelect:d,defaultArray:n,userList:r,optionData:c});var m=s;f.setFieldsValue({keys:m})}else t.setState({relationList:e.data.relation,formSelect:[k({andOr:"and"},n)],defaultArray:n,userList:r})}}));case 1:case"end":return e.stop()}}),e)})))),(0,y.default)((0,p.default)(t),"onOrAndChange",(function(e,a){var n=t.state.formSelect;n.filter((function(e,t){return 0!=t})).map((function(t){t.andOr=e})),t.setState({formSelect:n,slevalue:e})})),(0,y.default)((0,p.default)(t),"onSecondChange",(function(e,a){var n=t.state.formSelect;"org"===e&&(n[a].relation="equals"),n[a].property=e,t.setState({formSelect:n})})),(0,y.default)((0,p.default)(t),"onThirdChange",(function(e,a){var n=t.state.formSelect;n[a].relation=e,n[a].value="",n[a].name="",t.setState({formSelect:n})})),(0,y.default)((0,p.default)(t),"onLastChange",(function(e,a,n,r){var l=t.state.formSelect;if("sel"==n){var o=r.props.attr;l[a].value=o,l[a].name=r.props.children}else l[a].value=e.target.value,l[a].name="";t.setState({formSelect:l})})),(0,y.default)((0,p.default)(t),"handleLastSearch",(function(e,a){var n=t.state.optionData;n[a]={pageNo:1,list:[]},t.setState({optionData:n,optionVal:e},(function(){t.changeOptionsData(a,e)}))})),(0,y.default)((0,p.default)(t),"changePopupScroll",(function(e,a){var n=t.state.optionData;n[a].pages&&n[a].pageNo==n[a].pages||e.target.scrollTop>=e.target.scrollHeight-e.target.offsetHeight-10&&(n[a].pageNo=n[a].pageNo+1,t.setState({optionData:n},(function(){t.changeOptionsData(a)})))})),(0,y.default)((0,p.default)(t),"handleFocus",(function(e,a){var n=t.state.formSelect,r=t.state.optionData;r[a]={pageNo:1,list:[]},console.log(n[a].value,"=====formSelect[index]"),t.setState({optionVal:"",optionData:r}),t.changeOptionsData(a)})),(0,y.default)((0,p.default)(t),"changeOptionsData",(function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1];var a=(0,p.default)(t),n=t.state.formSelect,r=t.state.optionData;t.props.recommendStrategyDrools({pageNo:a.state.optionData[e].pageNo,pageSize:a.state.pageSize,taskParamsType:n[e].property,taskParamsValue:t.state.optionVal,taskType:"user"},(function(t){0!=t.data.records.length&&(r[e].list.length&&1!=r[e].pageNo?(r[e].list=[].concat((0,i.default)(a.state.optionData[e].list),(0,i.default)(t.data.records)),r[e].pages=t.data.pages):(r[e].list=t.data.records||[],r[e].pages=t.data.pages),a.setState({optionData:r}))}))})),(0,y.default)((0,p.default)(t),"remove",(function(e,a){var n=t.props.form,r=n.getFieldValue("keys");if(1===r.length)return u.default.info("至少保留一个策略!!!");n.setFieldsValue({keys:r.filter((function(t){return t!==e}))});var l=t.state.formSelect;l.splice(a,1),t.setState({formSelect:l})})),(0,y.default)((0,p.default)(t),"add",(function(){var e=t.state,a=e.formSelect,n=e.defaultArray,r=e.optionData,l=e.slevalue;r.push({pageNo:1,list:[]}),a.push(k({andOr:l},n));var o=t.props.form,u=o.getFieldValue("keys").concat(C++);t.setState({formSelect:a}),o.setFieldsValue({keys:u})})),(0,y.default)((0,p.default)(t),"up",(function(e){var a=t.props.form;if(0===e)return u.default.info("已经是排在第一位了,不能移动了!!!");var n=a.getFieldValue("keys");n.splice(e-1,0,n[e]),n.splice(e+1,1),a.setFieldsValue({keys:n});var r=t.state.formSelect;r.splice(e-1,0,r[e]),r.splice(e+1,1),t.setState({formSelect:r})})),(0,y.default)((0,p.default)(t),"down",(function(e){var a=t.props.form,n=a.getFieldValue("keys");if(e===n.length-1)return u.default.info("下面已经没有选项可以移动了!!!");n.splice(e+2,0,n[e]),n.splice(e,1),a.setFieldsValue({keys:n});var r=t.state.formSelect;r.splice(e+2,0,r[e]),r.splice(e,1),t.setState({formSelect:r})})),(0,y.default)((0,p.default)(t),"rulesSubmit",(0,d.default)(c.default.mark((function e(){var a,n,r,l,o;return c.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(a=t.state.formSelect,n=[],r=0;r<a.length;r++)n.push((l={andOr:a[r][0],property:a[r][1]},(0,y.default)(l,"property",a[r][2]),(0,y.default)(l,"relation",a[r][3]),(0,y.default)(l,"sort",r),l));o={andOr:"and",list:n,sort:0,template:!0,type:"2",value:"用户规则"},t.props.recommendRuleTemplateSave(o,(function(e){"success"==response.msg?u.default.success("保存成功"):u.default.error("保存失败")}));case 5:case"end":return e.stop()}}),e)})))),t.state={currentClassify:"",relationList:[],initData:[{init:"初始化"}],defaultArray:[],formSelect:[],thirdly:[],userList:[],optionVal:"",optionData:[{pageNo:1,list:[]}],slevalue:"and"},t}return(0,s.default)(n,[{key:"componentDidMount",value:function(){this.queryData()}},{key:"render",value:function(){var e=this,t=this.state,a=t.initData,n=t.relationList,r=t.formSelect,u=t.userList,i=this.props.form,c=i.getFieldDecorator,d=i.getFieldValue;c("keys",{initialValue:a});var f=d("keys"),s=!!this.props.editOrNo&&this.props.editOrNo,p=f.map((function(t,a){var i;if(r.length)return b.default.createElement(E,{className:"rules-from-item-"+a,key:t},b.default.createElement("div",{style:{display:"inline-block",width:100,marginRight:"10px"}},a?b.default.createElement(v.default,{disabled:s,onChange:function(t){return e.onOrAndChange(t,a)},value:r[a].andOr},b.default.createElement(P,{value:"and"},"且"),b.default.createElement(P,{value:"or"},"或")):b.default.createElement(v.default,(i={disabled:s,onChange:function(t){return e.onOrAndChange(t,a)}},(0,y.default)(i,"disabled",!0),(0,y.default)(i,"defaultValue","and"),i),b.default.createElement(P,{value:"and"},"若"))),b.default.createElement(v.default,{disabled:s,defaultValue:r[a].property,onChange:function(t){return e.onSecondChange(t,a)},style:{width:120,marginRight:"10px"}},u&&Object.keys(u).map((function(e){return b.default.createElement(P,{key:e,value:e},u[e])}))),"all"==r[a].property||r[a]&&"org"==r[a].property?"":b.default.createElement(v.default,{disabled:s,style:{width:120,marginRight:"10px"},onChange:function(t){e.onThirdChange(t,a)},defaultValue:e.state.formSelect[a].relation},n&&Object.keys(n).map((function(e){return b.default.createElement(P,{key:e,value:e},n[e])}))),r[a]&&"org"==r[a].property?b.default.createElement(v.default,{disabled:s,style:{width:120,marginRight:"10px"},onChange:function(t){e.onThirdChange(t,a)},defaultValue:e.state.formSelect[a].relation},n&&Object.keys(n).filter((function(e){return"contains"!==e&&"notContains"!==e})).map((function(e){return b.default.createElement(P,{key:e,value:e},n[e])}))):"","equals"==r[a].relation&&"all"!==r[a].property||"notEquals"==r[a].relation&&"all"!==r[a].property?b.default.createElement(v.default,{showSearch:!0,value:r[a].name||"",onChange:function(t,n){return e.onLastChange(t,a,"sel",n)},style:{width:120,marginRight:"10px"},onSearch:function(t){return e.handleLastSearch(t,a)},defaultActiveFirstOption:!1,showArrow:!1,onPopupScroll:function(t){return e.changePopupScroll(t,a)},onFocus:function(t){return e.handleFocus(t,a)},disabled:s},e.state.optionData[a].list.length&&e.state.optionData[a].list.map((function(e,t){return b.default.createElement(P,{key:e.taskId+e.taskFieldValue+t,value:e.taskId+e.taskFieldValue,attr:e.taskId},e.taskFieldValue)}))):"all"==r[a].property?"":b.default.createElement(o.default,{disabled:s,onChange:function(t){return e.onLastChange(t,a,"inp")},value:r[a].value||"",style:{width:120,marginRight:"10px"}}),!s&&b.default.createElement("span",null,b.default.createElement("a",null,b.default.createElement(l.default,{type:"plus",style:{marginRight:"10px",fontSize:"24px",color:"#9a8e8e"},onClick:e.add})),b.default.createElement("a",null,b.default.createElement(l.default,{type:"close",style:{marginRight:"10px",fontSize:"24px",color:"#9a8e8e"},onClick:function(){return e.remove(t,a)}})),b.default.createElement("a",null,b.default.createElement(l.default,{type:"caret-up",style:{marginRight:"10px",fontSize:"24px",color:"#9a8e8e"},onClick:function(){return e.up(a)}})),b.default.createElement("a",null,b.default.createElement(l.default,{type:"caret-down",style:{fontSize:"24px",color:"#9a8e8e"},onClick:function(){return e.down(a)}}))))}));return b.default.createElement("div",null,b.default.createElement(S.default,{className:"rules-from",style:{width:this.props.width||"100%",border:"1px solid #0f8de6",padding:"4%"}},p))}}]),n}(b.Component),j=(0,D.connect)((function(e){return e}),k({},O))(S.default.create()(x));t.default=j},1476:function(e,t,a){"use strict";var n=a(0);a(44),Object.defineProperty(t,"__esModule",{value:!0}),t.recommendRuleTemplateSave=function(e){return post("/rules/manage/recommendRule/template/save?companyCode=".concat(companyCode,"&siteCode=").concat(siteCode),e)},t.default=void 0;var r=n(a(63)),l={recommendRulePageApi:"GET ".concat(r.default.base,"/rules/manage/recommendRule/page"),recommendRuleCopyApi:"POST ".concat(r.default.base,"/rules/manage/recommendRule/copy"),recommendRuleDeleteApi:"POST ".concat(r.default.base,"/rules/manage/recommendRule/delete"),getVisibleRangeToContentApi:"GET ".concat(r.default.base,"/rules/manage/recommendRule/content/range/page"),recommendRuleGetVisibleRangeToUserApi:"GET ".concat(r.default.base,"/rules/manage/recommendRule/getVisibleRangeToUser"),recommendRuleStrategyPageApi:"GET ".concat(r.default.base,"/rules/manage/recommendRule/strategy/page"),recommendRuleIdsGetApi:"POST ".concat(r.default.base,"/rules/manage/recommendRule/ids/get"),recommendRuleTemplateSaveApi:"POST ".concat(r.default.base,"/rules/manage/recommendRule/template/save")};t.default=l},1477:function(e,t,a){"use strict";var n=a(4),r=a(0);a(51),a(20),a(34),a(23),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a(224);var l=r(a(225));a(140);var o=r(a(535));a(537);var u=r(a(536)),i=r(a(238));a(239);var c=r(a(240)),d=r(a(29)),f=r(a(30)),s=r(a(59)),p=r(a(32)),m=r(a(33)),g=r(a(31)),h=r(a(2));a(540);var y=r(a(539)),v=n(a(1)),S=r(a(1329)),b=a(52),D=n(a(1386));function O(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function w(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var k=y.default.Item,R=function(e){(0,p.default)(n,e);var t,a=(t=n,function(){var e,a=(0,g.default)(t);if(w()){var n=(0,g.default)(this).constructor;e=Reflect.construct(a,arguments,n)}else e=a.apply(this,arguments);return(0,m.default)(this,e)});function n(e){var t;return(0,d.default)(this,n),t=a.call(this,e),(0,h.default)((0,s.default)(t),"columns",[{title:"序号",dataIndex:"id",render:function(e,a,n){return(t.state.pageNo-1)*t.state.pageSize+n+1}},{title:"策略名称",dataIndex:"name",render:function(e){return v.default.createElement("span",{title:e},e.length>10?e.substring(9,0)+"...":e)}}]),(0,h.default)((0,s.default)(t),"queryData",(0,c.default)(i.default.mark((function e(){var a,n;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a={ruleId:t.props.lookDataId,name:t.state.name,pageNo:t.state.pageNo,pageSize:t.state.pageSize},n=(0,s.default)(t),t.props.recommendRuleStrategyPage(a,(function(e){1e3==e.code&&n.setState({tableData:e.data,dataTotal:e.page.pageTotal})}));case 3:case"end":return e.stop()}}),e)})))),(0,h.default)((0,s.default)(t),"changePageNo",(function(e){t.setState({pageNo:e},(function(){t.queryData()}))})),(0,h.default)((0,s.default)(t),"onShowSizeChange",(function(e,a){t.setState({pageNo:e,pageSize:a},(function(){t.queryData()}))})),(0,h.default)((0,s.default)(t),"handleSubmit",(function(e){e.preventDefault(),t.props.form.validateFields((function(e,a){e||t.setState({pageNo:1,name:a.keyword},(function(){t.queryData()}))}))})),t.state={cacheList:[],contentVisible:!1,tableData:[],dataTotal:0,name:"",resData:{},pageNo:1,pageSize:10},t}return(0,f.default)(n,[{key:"componentDidMount",value:function(){this.queryData()}},{key:"render",value:function(){var e=this,t=this.props.form.getFieldDecorator,a=this.state,n=a.tableData,r=a.dataTotal;return v.default.createElement(l.default,{onCancel:function(){return e.props.handleCancel(0)},footer:null,width:1e3,title:"关联活动",visible:this.props.modalVisible},v.default.createElement(y.default,{onSubmit:this.handleSubmit},v.default.createElement(k,{style:{marginBottom:"6px"}},"关键字：",t("keyword")(v.default.createElement(u.default,{size:"small",placeholder:"请输入关联活动名称",style:{width:"200px"}})),v.default.createElement(o.default,{size:"small",style:{marginLeft:"8px"},htmlType:"submit",type:"primary"},"搜索"))),v.default.createElement("p",{style:{fontSize:"16px"}},"推荐策略"),v.default.createElement(S.default,{rowKey:"num",style:{border:"1px solid #fff"},size:"middle",columns:this.columns,tableData:n,dataTotal:r,paginationStyle:{style:{float:"none",margin:"20px auto",marginLeft:"50%",transform:"translateX(-44%)"},size:"small"},changePageNo:this.changePageNo,onShowSizeChange:this.onShowSizeChange}))}}]),n}(v.Component),E=(0,b.connect)((function(e){return e}),function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?O(Object(a),!0).forEach((function(t){(0,h.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):O(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({},D))(y.default.create()(R));t.default=E},1808:function(e,t,a){"use strict";var n=a(4),r=a(0);a(20),a(34),a(23),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a(140);var l=r(a(535));a(537);var o=r(a(536));a(61);var u=r(a(62)),i=r(a(238));a(239);var c=r(a(240));a(564);var d=r(a(563)),f=r(a(29)),s=r(a(30)),p=r(a(59)),m=r(a(32)),g=r(a(33)),h=r(a(31)),y=r(a(2));a(592);var v=r(a(566));a(540);var S=r(a(539)),b=n(a(1)),D=(a(636),r(a(1329))),O=r(a(226)),w=a(52),k=n(a(1386)),R=r(a(1809)),E=r(a(1810)),P=r(a(1477)),C=r(a(223));function x(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function j(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var T=S.default.Item,V=(v.default.RangePicker,function(e){(0,m.default)(n,e);var t,a=(t=n,function(){var e,a=(0,h.default)(t);if(j()){var n=(0,h.default)(this).constructor;e=Reflect.construct(a,arguments,n)}else e=a.apply(this,arguments);return(0,g.default)(this,e)});function n(e){var t;return(0,f.default)(this,n),t=a.call(this,e),(0,y.default)((0,p.default)(t),"columns",[{title:"序号",dataIndex:"id",render:function(e,a,n){return(t.state.pageNo-1)*t.state.pageSize+n+1}},{title:"规则名称",dataIndex:"name",render:function(e){return b.default.createElement("span",{title:e},e.length>10?e.substring(9,0)+"...":e)}},{title:"创建时间",dataIndex:"createTime",width:300,render:function(e,t){return b.default.createElement("span",null,(0,C.default)(e).format("YYYY-MM-DD HH:mm:ss"))}},{title:"操作",dataIndex:"action",render:function(e,a){return b.default.createElement("span",null,b.default.createElement(d.default,{style:{minWidth:"180px"},title:"确定复制？",onConfirm:function(){return t.handleCopyRow(a.id)}},b.default.createElement("a",{href:"#"},"复制")),b.default.createElement("a",{onClick:function(e){return t.editModal(e,a)},style:{marginLeft:"10px"}},"修改"),b.default.createElement("a",{style:{marginLeft:"10px"},onClick:function(){return t.handleLookScope(a)}},"查看规则范围"),b.default.createElement("a",{style:{marginLeft:"10px"},onClick:function(){return t.handleLookActivity(a)}},"查看关联活动"),b.default.createElement(d.default,{style:{minWidth:"180px"},title:"确定删除？",onConfirm:function(){return t.handleDeleteRow(a.id)}},b.default.createElement("a",{href:"#",style:{marginLeft:"10px"}},"删除")))}}]),(0,y.default)((0,p.default)(t),"queryData",(0,c.default)(i.default.mark((function e(){var a,n,r;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=t.props.form.getFieldValue("ruleName"),n={name:a||"",pageNo:t.state.pageNo,pageSize:t.state.pageSize,type:"2"},r=(0,p.default)(t),t.props.recommendRulePage(n,(function(e){r.setState({tableData:e.data,dataTotal:e.page.pageTotal})}));case 4:case"end":return e.stop()}}),e)})))),(0,y.default)((0,p.default)(t),"handleSubmit",(function(e){e.preventDefault(),t.setState({pageNo:1},(function(){t.queryData()}))})),(0,y.default)((0,p.default)(t),"changePageNo",(function(e){t.setState({pageNo:e},(function(){t.queryData()}))})),(0,y.default)((0,p.default)(t),"onShowSizeChange",(function(e,a){t.setState({pageNo:e,pageSize:a},(function(){t.queryData()}))})),(0,y.default)((0,p.default)(t),"handleModal",(function(){t.setState({lookDataId:"",modalVisible:!0})})),(0,y.default)((0,p.default)(t),"handleCopyRow",function(){var e=(0,c.default)(i.default.mark((function e(a){var n;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=(0,p.default)(t),t.props.recommendRuleCopy({id:a},(function(e){1e3==e.code?(u.default.success("复制成功"),n.queryData()):u.default.error("复制失败")}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),(0,y.default)((0,p.default)(t),"editModal",(function(e,a){e.preventDefault(),t.setState({lookDataId:a.id,modalVisible:!0})})),(0,y.default)((0,p.default)(t),"handleLookScope",(function(e){t.setState({lookDataId:e.id,lookScopeVisible:!0})})),(0,y.default)((0,p.default)(t),"handleLookActivity",(function(e){t.setState({lookDataId:e.id,lookCorrelateionVisible:!0})})),(0,y.default)((0,p.default)(t),"handleDeleteRow",function(){var e=(0,c.default)(i.default.mark((function e(a){return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.props.recommendRuleDelete({id:a},(function(e){if(1e3==e.code){u.default.success("删除成功");var a=t.state,n=a.tableData,r=a.pageNo;1==n.length&&1!=r?t.setState({pageNo:r-1},(function(){t.queryData()})):t.queryData()}else u.default.error("删除失败")}));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),(0,y.default)((0,p.default)(t),"handleCancel",(function(e){1==e&&t.queryData(),t.setState({modalVisible:!1,lookScopeVisible:!1,lookCorrelateionVisible:!1})})),t.state={modalVisible:!1,lookScopeVisible:!1,lookCorrelateionVisible:!1,tableData:[],dataTotal:0,pageNo:1,pageSize:10,lookDataId:"",addOrEdit:"add"},t}return(0,s.default)(n,[{key:"componentDidMount",value:function(){this.queryData()}},{key:"render",value:function(){var e=this.state,t=e.tableData,a=e.dataTotal,n=this.props.form.getFieldDecorator;return b.default.createElement("div",{style:{padding:"2%"}},b.default.createElement(O.default,{title:"用户规则"}),b.default.createElement("div",{className:"header-rules--search"},b.default.createElement(S.default,{layout:"inline",onSubmit:this.handleSubmit,style:{paddingBottom:30}},b.default.createElement(T,{label:"规则名称："},n("ruleName")(b.default.createElement(o.default,{style:{width:"250px"},placeholder:"请输入规则名称"}))),b.default.createElement(T,null,b.default.createElement(l.default,{type:"primary",htmlType:"submit"},"查询"),b.default.createElement(l.default,{style:{marginLeft:"16px"},onClick:this.handleModal,type:"primary"},"新建规则")))),b.default.createElement(D.default,{columns:this.columns,tableData:t,dataTotal:a,changePageNo:this.changePageNo,onShowSizeChange:this.onShowSizeChange}),this.state.modalVisible&&b.default.createElement(R.default,{lookDataId:this.state.lookDataId,modalVisible:this.state.modalVisible,handleCancel:this.handleCancel}),this.state.lookScopeVisible&&b.default.createElement(E.default,{tip:"user",lookDataId:this.state.lookDataId,modalVisible:this.state.lookScopeVisible,handleCancel:this.handleCancel}),this.state.lookCorrelateionVisible&&b.default.createElement(P.default,{lookDataId:this.state.lookDataId,modalVisible:this.state.lookCorrelateionVisible,handleCancel:this.handleCancel}))}}]),n}(b.Component)),N=(0,w.connect)((function(e){return e}),function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?x(Object(a),!0).forEach((function(t){(0,y.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):x(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({},k))(S.default.create({})(V));t.default=N},1809:function(e,t,a){"use strict";var n=a(4),r=a(0);a(7),a(44),a(3),a(5),a(43),a(51),a(9),a(10),a(8),a(20),a(34),a(23),a(228),a(6),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a(224);var l=r(a(225)),o=r(a(98));a(537);var u=r(a(536));a(61);var i=r(a(62)),c=r(a(238));a(239);var d=r(a(240)),f=r(a(29)),s=r(a(30)),p=r(a(59)),m=r(a(32)),g=r(a(33)),h=r(a(31)),y=r(a(2));a(540);var v=r(a(539)),S=n(a(1)),b=r(a(1475)),D=a(52),O=n(a(1386));function w(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function k(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?w(Object(a),!0).forEach((function(t){(0,y.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):w(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function R(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var E=v.default.Item,P={labelCol:{xs:{span:12},sm:{span:3}},wrapperCol:{xs:{span:24},sm:{span:21}}},C=function(e){(0,m.default)(n,e);var t,a=(t=n,function(){var e,a=(0,h.default)(t);if(R()){var n=(0,h.default)(this).constructor;e=Reflect.construct(a,arguments,n)}else e=a.apply(this,arguments);return(0,g.default)(this,e)});function n(e){var t;return(0,f.default)(this,n),t=a.call(this,e),(0,y.default)((0,p.default)(t),"queryData",function(){var e=(0,d.default)(c.default.mark((function e(a){var n;return c.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=[a],t.props.recommendRuleIdsGet([].concat(n),(function(e){1e3==e.code&&(t.props.form.setFieldsValue({name:e.data[a].name}),t.setState({resData:e.data[a],cacheList:e.data[a].list},(function(){t.setState({contentVisible:!0})})))}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),(0,y.default)((0,p.default)(t),"handleSubmit",(function(e){e.preventDefault();var a=!1;t.props.form.validateFields((function(e,n){if(!e){var r=t.state.resData,l=t.addRef.state.formSelect.map((function(e,t){return e.value&&""!=e.value.trim()||"all"===e.property||(i.default.error("请填写完整内容规则条件"),a=!0),k({},e,{business:"user",sort:t+1})}));if(!a){var o={name:n.name,list:l,template:!1,type:2,sort:1};t.props.lookDataId&&(r.list=l,r.sort=1,r.id=t.props.lookDataId,r.name=n.name,o=r),t.props.recommendRuleTemplateSave(o,(function(e){1e3==e.code&&i.default.success("保存成功"),t.props.handleCancel(1)}))}}}))})),t.state={cacheList:[],contentVisible:!1,resData:{}},t}return(0,s.default)(n,[{key:"componentDidMount",value:function(){this.props.lookDataId?this.queryData(this.props.lookDataId):this.setState({contentVisible:!0})}},{key:"render",value:function(){var e=this,t=this.props.form.getFieldDecorator,a=this.props.lookDataId?"修改用户规则":"新建用户规则";return S.default.createElement(l.default,{onCancel:function(){return e.props.handleCancel(0)},onOk:this.handleSubmit,width:1e3,title:a,visible:this.props.modalVisible},S.default.createElement(v.default,(0,o.default)({},P,{onSubmit:this.handleSubmit}),S.default.createElement(E,{label:"规则名称"},t("name",{rules:[{required:!0,message:"请输入规则名称(50字内)"}]})(S.default.createElement(u.default,{placeholder:"请输入规则名称(50字内)",maxLength:50,style:{width:"300px"}}))),S.default.createElement(E,(0,o.default)({},P,{label:"用户规则",required:!0}),S.default.createElement("div",null,this.state.contentVisible&&S.default.createElement(b.default,{cacheList:this.state.cacheList,wrappedComponentRef:function(t){return e.addRef=t}})))))}}]),n}(S.Component),x=(0,D.connect)((function(e){return e}),k({},O))(v.default.create()(C));t.default=x},1810:function(e,t,a){"use strict";var n=a(4),r=a(0);a(20),a(34),a(23),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a(224);var l=r(a(225));a(140);var o=r(a(535));a(537);var u=r(a(536)),i=r(a(238));a(239);var c=r(a(240)),d=r(a(29)),f=r(a(30)),s=r(a(59)),p=r(a(32)),m=r(a(33)),g=r(a(31)),h=r(a(2));a(540);var y=r(a(539)),v=n(a(1)),S=r(a(1329)),b=a(52),D=n(a(1386));function O(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function w(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var k=y.default.Item,R=function(e){(0,p.default)(n,e);var t,a=(t=n,function(){var e,a=(0,g.default)(t);if(w()){var n=(0,g.default)(this).constructor;e=Reflect.construct(a,arguments,n)}else e=a.apply(this,arguments);return(0,m.default)(this,e)});function n(e){var t;return(0,d.default)(this,n),t=a.call(this,e),(0,h.default)((0,s.default)(t),"columnsUser",[{title:"序号",dataIndex:"id",render:function(e,a,n){return(t.state.pageNo-1)*t.state.pageSize+n+1}},{title:"用户名",dataIndex:"name",render:function(e){return v.default.createElement("span",{title:e},e.length>10?e.substring(9,0)+"...":e)}},{title:"姓名",dataIndex:"fullName",render:function(e){return v.default.createElement("span",{title:e},e.length>10?e.substring(9,0)+"...":e)}},{title:"手机号",dataIndex:"mobile"},{title:"职务",dataIndex:"position",render:function(e){return v.default.createElement("span",{title:e},e.length>10?e.substring(9,0)+"...":e)}}]),(0,h.default)((0,s.default)(t),"columnsContent",[{title:"序号",dataIndex:"num",render:function(e,a,n){return(t.state.pageNo-1)*t.state.pageSize+n+1}},{title:"内容编码",dataIndex:"code",render:function(e){return v.default.createElement("span",{title:e},e.length>10?e.substring(9,0)+"...":e)}},{title:"内容类型",dataIndex:"business",render:function(e){return v.default.createElement("span",{title:e},e.length>10?e.substring(9,0)+"...":e)}},{title:"内容名称",dataIndex:"content",render:function(e){return v.default.createElement("span",{title:e},e.length>10?e.substring(9,0)+"...":e)}}]),(0,h.default)((0,s.default)(t),"queryData",function(){var e=(0,c.default)(i.default.mark((function e(a){var n;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n={id:t.props.lookDataId,keyword:t.state.keyword,pageNo:t.state.pageNo,pageSize:t.state.pageSize},"content"==t.props.tip?t.props.getVisibleRangeToContent(n,(function(e){1e3==e.code&&t.setState({tableData:e.data,dataTotal:e.page.pageTotal})})):t.props.recommendRuleGetVisibleRangeToUser(n,(function(e){1e3==e.code&&(console.log("^^^^^^^^",e),t.setState({tableData:e.data,dataTotal:e.page.pageTotal}))}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),(0,h.default)((0,s.default)(t),"changePageNo",(function(e){t.setState({pageNo:e},(function(){t.queryData()}))})),(0,h.default)((0,s.default)(t),"onShowSizeChange",(function(e,a){t.setState({pageNo:e,pageSize:a},(function(){t.queryData()}))})),(0,h.default)((0,s.default)(t),"handleSubmit",(function(e){e.preventDefault(),t.props.form.validateFields((function(e,a){e||t.setState({pageNo:1,keyword:a.keyword},(function(){t.queryData()}))}))})),t.state={cacheList:[],contentVisible:!1,tableData:[],dataTotal:0,keyword:"",resData:{},pageNo:1,pageSize:10},t}return(0,f.default)(n,[{key:"componentDidMount",value:function(){this.queryData()}},{key:"render",value:function(){var e=this,t=this.props.form.getFieldDecorator,a=this.state,n=a.tableData,r=a.dataTotal;return v.default.createElement(l.default,{onCancel:function(){return e.props.handleCancel(0)},footer:null,width:"80%",title:"查看规则范围",visible:this.props.modalVisible},v.default.createElement(y.default,{onSubmit:this.handleSubmit},v.default.createElement(k,{style:{marginBottom:"6px"}},t("keyword")(v.default.createElement(u.default,{size:"small",placeholder:"请输入用户名/姓名/手机号",style:{width:"200px"}})),v.default.createElement(o.default,{size:"small",style:{marginLeft:"8px"},htmlType:"submit",type:"primary"},"搜索"))),v.default.createElement(S.default,{rowKey:"num",style:{border:"1px solid #fff"},size:"middle",columns:"content"==this.props.tip?this.columnsContent:this.columnsUser,tableData:n,dataTotal:r,paginationStyle:{style:{float:"none"},size:"small"},changePageNo:this.changePageNo,onShowSizeChange:this.onShowSizeChange}))}}]),n}(v.Component),E=(0,b.connect)((function(e){return e}),function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?O(Object(a),!0).forEach((function(t){(0,h.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):O(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({},D))(y.default.create()(R));t.default=E},535:function(e,t,a){e.exports=a(11)(70)},536:function(e,t,a){e.exports=a(11)(166)},539:function(e,t,a){e.exports=a(11)(821)},540:function(e,t,a){"use strict";a.r(t);a(26),a(577),a(584)},544:function(e,t,a){e.exports=a(11)(846)},550:function(e,t,a){e.exports=a(11)(94)},558:function(e,t,a){e.exports=a(11)(251)},563:function(e,t,a){e.exports=a(11)(837)},564:function(e,t,a){"use strict";a.r(t);a(26),a(581),a(140)},566:function(e,t,a){e.exports=a(11)(817)},577:function(e,t,a){},581:function(e,t,a){"use strict";a.r(t);a(26),a(585)},585:function(e,t,a){},636:function(e,t,a){e.exports=a(46)(174)}}]);